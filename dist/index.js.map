{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./sources/theatre/core/loadRenderers.js","webpack:///./sources/theatre/core/loadSystems.js","webpack:///./sources/theatre/core/loadEntities.js","webpack:///./sources/theatre/modules/world.js","webpack:///./sources/theatre/modules/ease.js","webpack:///./sources/game/models/systems/demo/generateDecor.js","webpack:///(webpack)/buildin/harmony-module.js","webpack:///./sources/game/scenes/demo/after.js","webpack:///./sources/game/scenes/demo/before.js","webpack:///./sources/game/scenes/demo/destroy.js","webpack:///./sources/game/scenes/demo/render.js","webpack:///./sources/game/scenes/demo/resize.js","webpack:///./sources/game/scenes/demo/start.js","webpack:///./sources/game/scenes/demo/update.js","webpack:///./sources/game/scenes/loading/after.js","webpack:///./sources/game/scenes/loading/before.js","webpack:///./sources/game/scenes/loading/destroy.js","webpack:///./sources/game/scenes/loading/render.js","webpack:///./sources/game/scenes/loading/resize.js","webpack:///./sources/game/scenes/loading/setup.js","webpack:///./sources/game/scenes/loading/start.js","webpack:///./sources/game/scenes/loading/update.js","webpack:///./sources/theatre/modules/camera.js","webpack:///./sources/theatre/modules/keynames.js","webpack:///./sources/theatre/modules/keyboard.js","webpack:///./sources/theatre/modules/mouse.js","webpack:///./sources/theatre/modules/controllers.js","webpack:///./sources/game/scenes/demo/setup.js","webpack:///./sources/game/assets lazy ^.\\/.+\\.[a-zA-Z0-9]+$","webpack:///./sources/game/models lazy ^.\\/.+\\.[a-zA-Z0-9]+$","webpack:///./sources/game/scenes sync ^\\.\\/[^\\/]+\\/index\\.js$","webpack:///./sources/game/scenes/demo/index.js","webpack:///./sources/game/scenes/loading/index.js","webpack:///./sources/theatre/core/canvas.js","webpack:///./sources/theatre/core/loop.js","webpack:///./sources/theatre/core/preloadAssets.js","webpack:///./sources/theatre/core/preloadModels.js","webpack:///./sources/theatre/core/preloadScenes.js","webpack:///./sources/index.js","webpack:///./sources/theatre/core/theatre.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","installedModules","0","__webpack_require__","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","p","jsonpScriptSrc","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","name","request","undefined","setTimeout","head","appendChild","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","s","loadRenderers","sceneRenderers","forEach","renderer","rendererSystem","getSystem","scope","$world","system","components","getRenderers","sceneModel","this","models","scenes","currentScene","renderers","systemName","systemScope","systems","loadSystems","sceneSystems","updateSystem","getSystems","systemModule","loadRef","ref","split","path","createNewParamsFromModel","paramsModel","params","newParams","keysParamsModel","keys","keyModel","modelNewParam","valueParam","_default","defaultValue","JSON","parse","stringify","_type","startsWith","Array","isArray","arraySubType","match","arrayObject","array","modelNewParamKeys","filter","modelNewParamKey","valueParamOfKey","newParamObject","convertArrayToObject","reduce","obj","item","getEntitiesScene","entities","generateEntities","sceneEntities","entityRef","entityDef","getEntityDefinition","componentsOverride","newEntityComponents","mergeDeep","isObject","objects","prev","pVal","oVal","concat","newEntity","generateEntityModel","values","Entity","entityModelOverride","loadedEntity","component","newComponent","createComponentFromModel","componentRef","componentModel","getComponentModel","loadEntities","add","has","iterator","search","replace","exclude","remove","World","context","entity","handler","chosen","entries","easeIn","power","x","easeOut","linear","factor","easeInQuart","easeOutQuad","easeOutQuart","reverse","generateDecor","maxId","spaceBehindBird","$camera","screen","width","scale","maxPosBeyondBird","position","minPosition","maxPosition","isOut","countEntities","idFloor","top","bottom","water","background","pipeTop","pipeBottom","map","originalModule","webpackPolyfill","children","after","$controllers","inputs","before","destroy","log","$origins","$systems","$renderers","render","fillStyle","fillRect","size","height","resize","start","update","character","delta","state","redirect","font","textAlign","textBaseline","fillText","preloading","setup","load","Camera","images","y","shaking","image","current","destination","z","splice","idle","look","frame","opacity","source","visible","alpha","globalAlpha","canvas","offset","Math","min","max","drawImage","left","right","abs","shake","duration","easing","Ease","force","elapsed","amplitude","angle","random","PI","round","cos","sin","camera","keynames","Keyboard","container","actions","states","blur","keydown","action","keyCode","indexOf","preventDefault","keyup","addEventListener","removeEventListener","Mouse","contextmenu","mousedown","button","buttons","rectangle","getBoundingClientRect","clientX","clientY","mouseenter","mouseleave","mousemove","mouseup","wheel","deltaY","deltaX","Controllers","controllers","controller","element","webpackAsyncContext","req","then","code","ids","id","webpackContext","webpackContextResolve","hot","accept","Canvas","identifier","pixelated","getContext","focus","ratio","devicePixelRatio","floor","style","sharp","imageRendering","imageSmoothingEnabled","Loop","framerate","speed","elapsedTime","lastUpdate","paused","currentUpdate","performance","now","requestAnimationFrame","pause","play","tick","times","preloadAssets","require","promiseArray","assetsLoaded","assetLoaded","find","asset","index","substring","Image","sound","Audio","oncanplaythrough","cloneNode","loadAsset","assets","preloadModels","modelsLoaded","componentLoaded","loadModel","default","preloadScenes","config","expose","offsetHeight","offsetWidth","loading","restarting","updates","forward","timeframe","playing","scene","$","snippets","version","restart","loop","promisePreloadAssets","promisePreloadModels","theatre","body","querySelector"],"mappings":"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","file":"index.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t};\n\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"\" + chunkId + \".index.js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 29);\n","const loadRenderers=function(sceneRenderers){\r\n  if(sceneRenderers){\r\n      sceneRenderers.forEach((renderer) => {\r\n      var rendererSystem=getSystem.call(this,renderer.name,renderer.scope);\r\n      this.$world.system(renderer.components, rendererSystem);\r\n    });\r\n  }\r\n}\r\n\r\nconst getRenderers=function(){\r\n  try{\r\n    let sceneModel=this.models.scenes[this.currentScene];\r\n    if(sceneModel!==undefined && sceneModel.renderers!=undefined && sceneModel.renderers() ){\r\n      return sceneModel.renderers();\r\n    }else return[];\r\n  }catch(err){\r\n    console.error(\"no renderers found for this scene :\"+this.currentScene);\r\n  }\r\n}\r\n\r\nconst getSystem=function(systemName,systemScope){\r\n  try{\r\n    if(typeof systemName!==\"string\"|| systemName===\"\"){\r\n      throw \"no system name defined\"\r\n    }\r\n    return this.models.systems[systemScope][systemName]()[systemName];\r\n    //return require('components/common/'+componentRef.name+'.json');\r\n  }catch(err){\r\n    throw \"no system found with name :\"+systemName;\r\n  }\r\n}\r\n\r\nexport {loadRenderers,getRenderers};\r\n","const loadSystems=function(sceneSystems){\r\n  sceneSystems.forEach((system) => {\r\n    var updateSystem=getSystem.call(this,system.name,system.scope);\r\n    this.$world.system(system.components, updateSystem);\r\n  });\r\n}\r\n\r\nconst getSystems=function(){\r\n  try{\r\n    let sceneModel=this.models.scenes[this.currentScene];\r\n    if(sceneModel!==undefined && sceneModel.systems!=undefined && sceneModel.systems() ){\r\n      return sceneModel.systems();\r\n    }else return[];\r\n  }catch(err){\r\n    console.error(\"no systems found for this scene :\"+this.currentScene)\r\n  }\r\n}\r\nconst getSystem=function(systemName,systemScope){\r\n  try{\r\n    if(typeof systemName!==\"string\"|| systemName===\"\"){\r\n      throw \"no system name defined\"\r\n    }\r\n    var systemModule=this.models.systems[systemScope][systemName]();\r\n    if(systemModule[systemName]){\r\n      return systemModule[systemName];\r\n    }else throw \"system don't export good systemName\";\r\n    //return require('components/common/'+componentRef.name+'.json');\r\n  }catch(err){\r\n    throw \"no system found with name :\"+systemName;\r\n  }\r\n}\r\n\r\nexport {loadSystems,getSystems};\r\n","import {Entity} from 'modules/world.js';\r\n\r\nconst loadRef=function(value){\r\n  try{\r\n    var ref=\"\";\r\n    value.split(\".\").forEach((path,i) => {\r\n      if(i==0){\r\n        ref=this[path]\r\n      }else{\r\n        ref=ref[path];\r\n      }\r\n    });\r\n    return ref\r\n  }catch(err){\r\n    throw err;\r\n  }\r\n}\r\n\r\nconst createNewParamsFromModel=function(paramsModel,params,deep=0){\r\n  try{\r\n    var newParams={};\r\n    var keysParamsModel=Object.keys(paramsModel);\r\n    for (var i = 0; i < keysParamsModel.length; i++) {\r\n      var keyModel=keysParamsModel[i];\r\n      var modelNewParam=paramsModel[keyModel];\r\n      var valueParam=params[keyModel];\r\n\r\n      if(valueParam==undefined){\r\n        if(modelNewParam._default==undefined){\r\n          throw \"error missing parameter :\"+keyModel;\r\n        }else{\r\n          var defaultValue=JSON.parse(JSON.stringify(modelNewParam._default));\r\n          if(modelNewParam._type===\"ref\"){\r\n            defaultValue=loadRef.call(this,defaultValue);\r\n          }\r\n          newParams[keyModel]=defaultValue;\r\n        }\r\n      }else {\r\n        if(modelNewParam._type.startsWith(\"array\") && Array.isArray(valueParam)){\r\n          newParams[keyModel]=[]\r\n          var arraySubType=modelNewParam._type.match(\"array<(.*)>\")[1];\r\n          if(arraySubType===\"array\"){\r\n              for (var c = 0; c < valueParam.length; c++) {\r\n                var arrayObject=createNewParamsFromModel.call(this,{array:modelNewParam[\"_\"+arraySubType]},{array:valueParam[c]});\r\n                newParams[keyModel].push(arrayObject[\"array\"]);\r\n              }\r\n          }else if(arraySubType===\"object\"){\r\n            for (var c = 0; c < valueParam.length; c++) {\r\n              newParams[keyModel].push(createNewParamsFromModel.call(this,modelNewParam[\"_\"+arraySubType],valueParam[c]));\r\n            }\r\n          }else if(arraySubType===\"string\"||arraySubType===\"number\"||arraySubType===\"boolean\"){\r\n            for (var c = 0; c < valueParam.length; c++) {\r\n              if(arraySubType!=typeof valueParam[c]){\r\n                throw \"wrong subType\"+arraySubType+\"in array model for param :\"+keyModel;\r\n              }\r\n              newParams[keyModel].push(valueParam[c]);\r\n            }\r\n          }else {\r\n            throw \"missing/wrong subType\"+arraySubType+\"in array model for param :\"+keyModel;\r\n          }\r\n        }else if(modelNewParam._type===\"object\" && typeof valueParam ===\"object\" && !Array.isArray(valueParam)){\r\n          newParams[keyModel]={}\r\n          var modelNewParamKeys= Object.keys(modelNewParam).filter(key=>!key.startsWith('_'));\r\n          for (var c = 0; c < modelNewParamKeys.length; c++) {\r\n            var modelNewParamKey=modelNewParamKeys[c]\r\n            var valueParamOfKey=valueParam[modelNewParamKey]?valueParam[modelNewParamKey]:{};\r\n            var newParamObject=createNewParamsFromModel.call(this,{[modelNewParamKey]:modelNewParam[modelNewParamKey]},{[modelNewParamKey]:valueParamOfKey});\r\n            newParams[keyModel][modelNewParamKey]=newParamObject[modelNewParamKey];\r\n          }\r\n        }else if(modelNewParam._type===typeof valueParam){\r\n          newParams[keyModel]=valueParam;\r\n        }else if(modelNewParam._type===\"ref\" && typeof valueParam ===\"string\" ){\r\n          newParams[keyModel]=loadRef.call(this,valueParam);\r\n        }else{\r\n          throw \"error wrong type parameters for \"+keyModel+\": waiting \"+modelNewParam._type+\" and get \"+typeof valueParam;\r\n        }\r\n      }\r\n    }\r\n    return newParams;\r\n  }catch(err){\r\n    throw err;\r\n  }\r\n};\r\n\r\nconst mergeDeep=(...objects)=> {\r\n  const isObject = obj => obj && typeof obj === 'object';\r\n\r\n  return objects.reduce((prev, obj) => {\r\n    Object.keys(obj).forEach(key => {\r\n      const pVal = prev[key];\r\n      const oVal = obj[key];\r\n\r\n      if (Array.isArray(pVal) && Array.isArray(oVal)) {\r\n        prev[key] = pVal.concat(...oVal);\r\n        //prev[key] = pVal;\r\n      }\r\n      else if (isObject(pVal) && isObject(oVal)) {\r\n        prev[key] = mergeDeep(pVal, oVal);\r\n      }\r\n      else {\r\n        prev[key] = oVal;\r\n      }\r\n    });\r\n\r\n    return prev;\r\n  }, {});\r\n}\r\n\r\n\r\nconst convertArrayToObject = (array, key) => {\r\n  const initialValue = {};\r\n  return array.reduce((obj, item) => {\r\n    return {\r\n      ...obj,\r\n      [item[key]]: item,\r\n    };\r\n  }, initialValue);\r\n};\r\n\r\nconst getEntitiesScene=function(){\r\n  try{\r\n    let currentScene=this.models.scenes[this.currentScene];\r\n    if(currentScene && currentScene.entities){\r\n      return currentScene.entities();\r\n    }\r\n  }catch(err){\r\n    console.error(\"no entities found for this scene :\"+this.currentScene)\r\n  }\r\n}\r\n\r\nconst generateEntities=function(sceneEntities){\r\n  try{\r\n    var entities=[];\r\n    sceneEntities.forEach((entityRef) => {\r\n      var entityDef=getEntityDefinition.call(this,entityRef);\r\n      var componentsOverride=convertArrayToObject(entityRef.components,'name');\r\n      var componentsModel=convertArrayToObject(entityDef.components,'name');\r\n      var newEntityComponents=mergeDeep(componentsModel,componentsOverride);\r\n      var newEntity=generateEntityModel.call(this,{name:entityDef.name,components:Object.values(newEntityComponents)});\r\n      newEntity=new Entity(newEntity.name,newEntity.components)\r\n      entities.push(newEntity);\r\n    });\r\n    return entities;\r\n  }catch(err){\r\n    console.error(err);\r\n  }\r\n}\r\n\r\n\r\nconst generateEntityModel=function(entityModelOverride){\r\n  try{\r\n    var loadedEntity={name:entityModelOverride.name,components:[]};\r\n    entityModelOverride.components.forEach((component) => {\r\n      var newComponent=createComponentFromModel.call(this,component);\r\n      loadedEntity.components.push(newComponent);\r\n    });\r\n    return loadedEntity;\r\n  }catch(err){\r\n    throw err;\r\n  }\r\n}\r\n\r\nconst createComponentFromModel=function(componentRef){\r\n  try{\r\n    var componentModel=getComponentModel.call(this,componentRef);\r\n    var params=componentRef.params?componentRef.params:{};\r\n    var newComponent=createNewParamsFromModel.call(this,componentModel.params,params);\r\n    newComponent.name=componentModel.name;\r\n    return newComponent;\r\n  }catch(err){\r\n    throw err;\r\n  }\r\n}\r\n\r\nconst getEntityDefinition=function(entityRef){\r\n  try{\r\n    if(typeof entityRef.name!==\"string\"|| entityRef.name===\"\"||typeof entityRef.scope!==\"string\" ||entityRef.scope===\"\" ){\r\n      throw \"no entity name defined\"\r\n    }\r\n    return this.models.entities[entityRef.scope][entityRef.name]();\r\n  }catch(err){\r\n    throw \"no entity found with name :\"+entityRef.name+\" and scope :\"+entityRef.scope;\r\n  }\r\n}\r\n\r\nconst getComponentModel=function(componentRef){\r\n  try{\r\n    if(typeof componentRef.name!==\"string\"|| componentRef.name===\"\"||typeof componentRef.scope!==\"string\" ||componentRef.scope===\"\"){\r\n      throw \"no component name defined\"\r\n    }\r\n    return this.models.components[componentRef.scope][componentRef.name]();\r\n  }catch(err){\r\n    throw \"no component found with name :\"+componentRef.name+\" and scope :\"+componentRef.scope;\r\n  }\r\n}\r\n\r\nconst loadEntities=function(){\r\n  var sceneEntities=getEntitiesScene.call(this);\r\n  return generateEntities.call(this,sceneEntities);\r\n}\r\n\r\nexport {loadEntities,generateEntities,createComponentFromModel};\r\n","function Entity(name, components) {\n\n    function add(components) {\n\n        if (Array.isArray(components) === false) {\n\n            components = [components];\n        }\n\n        components.forEach((component) => {\n\n            this.components[component.name] = component;\n        });\n    }\n\n    function get(component) {\n\n        return this.components[component];\n    }\n\n    function has(components) {\n\n        if (Array.isArray(components) === false) {\n\n            components = [components];\n        }\n\n        for (let iterator = 0, length = components.length; iterator < length; iterator += 1) {\n\n            const search = components[iterator];\n            const component = search.replace('not:', '');\n            const exclude = search !== component;\n\n            if (this.components.hasOwnProperty(component) === exclude) {\n\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    function remove(components) {\n\n        if (Array.isArray(components) === false) {\n\n            components = [components];\n        }\n\n        for (let iterator = 0, length = components.length; iterator < length; iterator += 1) {\n\n            const component = components[iterator];\n\n            if (this.components.hasOwnProperty(component) === true) {\n\n                delete this.components[component];\n            }\n        }\n    }\n\n    this.components = {};\n    this.name = name;\n\n    this.add = add;\n    this.get = get;\n    this.has = has;\n    this.remove = remove;\n\n    this.add(components);\n}\n\nfunction World(context) {\n\n    function add(entities) {\n\n        if (Array.isArray(entities) === false) {\n\n            entities = [entities];\n        }\n\n        entities.forEach((entity) => {\n\n            this.entities[entity.name] = entity;\n        });\n    }\n\n    function get(entity) {\n\n        return this.entities[entity];\n    }\n\n    function remove(entities) {\n\n        if (Array.isArray(entities) === false) {\n\n            entities = [entities];\n        }\n\n        for (let iterator = 0, length = entities.length; iterator < length; iterator += 1) {\n\n            const entity = entities[iterator];\n            const key = entity.name || entity;\n\n            if (this.entities.hasOwnProperty(key) === true) {\n\n                delete this.entities[key];\n            }\n        }\n    }\n\n    function system(components, handler, entities = this.entities) {\n\n        const chosen = {};\n\n        Object.entries(entities).forEach(([name, entity]) => {\n\n            if (entity.has(components) === true) {\n\n                chosen[name] = entity;\n            }\n        });\n\n        handler.call(context, chosen);\n    }\n\n    this.entities = {};\n\n    this.add = add;\n    this.get = get;\n    this.remove = remove;\n    this.system = system;\n}\n\nexport {\n\n    // exports current module as an object\n    World,\n\n    // exports helpers for current module\n    Entity\n};\n","function easeIn(power) {\n\n    // accelerating from zero velocity\n    return (x) => x ** power;\n}\n\nfunction easeInOut(power) {\n\n    // acceleration until halfway, then deceleration (with x in [0, 1] range)\n    return (x) => {\n\n        if (x < 0.5) {\n\n            return easeIn(power)(2 * x) / 2\n        }\n\n        return 1 - easeInOut(power)(1 - x)\n    }\n}\n\nfunction easeOut(power) {\n\n    // decelerating to zero velocity (with x in [0, 1] range)\n    return (x) => 1 - easeIn(power)(1 - x);\n}\n\nfunction linear(factor) {\n\n    // linear progression\n    return (x) => x * factor;\n}\n\nfunction easeInQuad(x) {\n\n    // accelerating from zero velocity\n    return easeIn(2)(x);\n}\n\nfunction easeInCubic(x) {\n\n    // accelerating from zero velocity\n    return easeIn(3)(x);\n}\n\nfunction easeInQuart(x) {\n\n    // accelerating from zero velocity\n    return easeIn(4)(x);\n}\n\nfunction easeInOutQuad(x) {\n\n    // acceleration until halfway, then deceleration (with x in [0, 1] range)\n    return easeInOut(2)(x);\n}\n\nfunction easeInOutCubic(x) {\n\n    // acceleration until halfway, then deceleration (with x in [0, 1] range)\n    return easeInOut(3)(x);\n}\n\nfunction easeInOutQuart(x) {\n\n    // acceleration until halfway, then deceleration (with x in [0, 1] range)\n    return easeInOut(4)(x);\n}\n\nfunction easeOutQuad(x) {\n\n    // decelerating to zero velocity (with x in [0, 1] range)\n    return easeOut(2)(x);\n}\n\nfunction easeOutCubic(x) {\n\n    // decelerating to zero velocity (with x in [0, 1] range)\n    return easeOut(3)(x);\n}\n\nfunction easeOutQuart(x) {\n\n    // decelerating to zero velocity (with x in [0, 1] range)\n    return easeOut(4)(x);\n}\n\nfunction reverse(handler) {\n\n    // reversing easing function\n    return (x) => handler(1 - x);\n}\n\n// exports current module as functions\nexport {\n\n    // export ease function creators\n    easeIn, easeInOut, easeOut, linear,\n\n    // export ease-in functions\n    easeInCubic, easeInQuad, easeInQuart,\n\n    // export ease-in-out functions\n    easeInOutCubic, easeInOutQuad, easeInOutQuart,\n\n    // export ease-out functions\n    easeOutCubic, easeOutQuad, easeOutQuart,\n\n    // export utility functions\n    reverse\n};\n","import {generateEntities} from 'core/loadEntities.js';\r\nimport top from 'entities/demo/top';\r\nimport bottom from 'entities/demo/bottom';\r\nimport water from 'entities/demo/water';\r\nimport background from 'entities/demo/background';\r\nimport pipeTop from 'entities/demo/pipeTop';\r\nimport pipeBottom from 'entities/demo/pipeBottom';\r\n\r\nfunction generateDecor(entities) {\r\n\r\n    let countEntities=0;\r\n    let maxId=0;\r\n    let spaceBehindBird=(this.$camera.screen.x()-this.$camera.screen.width()/(this.$camera.screen.scale()*2));\r\n    let maxPosBeyondBird=this.$camera.position.x()+(this.$camera.screen.x()+this.$camera.screen.width()/(this.$camera.screen.scale()*2));\r\n    let minPosition=this.$camera.position.x()+spaceBehindBird;\r\n    let maxPosition=minPosition;\r\n\r\n\r\n    Object.entries(entities).filter(([name,entity])=>{\r\n      let isOut=(entity.get('position').x+90)<minPosition;\r\n      if(isOut)this.$world.remove(entity);\r\n      return !isOut;\r\n    });\r\n\r\n    Object.entries(entities).forEach(([name, entity]) => {\r\n      if(name.startsWith('bottom')){\r\n        countEntities++;\r\n        let idFloor=name.split('bottom')[1];\r\n        idFloor=idFloor;\r\n        if(idFloor>maxId){\r\n          maxId=idFloor;\r\n          maxPosition=entity.get('position').x+entity.get('hitbox').width;\r\n        }\r\n      }\r\n    });\r\n\r\n    top.scope=\"demo\";\r\n    bottom.scope=\"demo\";\r\n    water.scope=\"demo\";\r\n    background.scope=\"demo\";\r\n    pipeTop.scope=\"demo\";\r\n    pipeBottom.scope=\"demo\";\r\n\r\n    while(maxPosBeyondBird>maxPosition ){\r\n      maxId++;\r\n      let newEntities=generateEntities.call(this,[top,bottom,background,water,pipeTop,pipeBottom]);\r\n      newEntities.map((newEntity)=>{\r\n        newEntity.name=newEntity.name+maxId;\r\n        newEntity.get('position').x=maxPosition;\r\n        this.$world.add(newEntity);\r\n      });\r\n      maxPosition=maxPosition+64;\r\n    }\r\n}\r\n\r\nexport {generateDecor};\r\n","module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","//import {debug} from 'systems/common/debug.js';\r\n\r\nfunction after() {\r\n\r\n    // console.log('lifecycle :', 'after demo scene');\r\n\r\n    /*this.$.world.system('debug', [], debug);\r\n\r\n    this.$.controllers.inputs.length = 0;*/\r\n  this.$controllers.inputs.length = 0;\r\n\r\n}\r\n\r\nexport {after};\r\n","function before() {\r\n\r\n}\r\n\r\nexport {before};\r\n","function destroy() {\n\n    console.log('destroy demo scene');\n    console.log('-------');\n\n    this.$controllers.destroy();\n\n    delete this.$camera;\n    delete this.$controllers;\n    delete this.$origins;\n    delete this.$world.entities;\n    delete this.$world;\n    delete this.$systems;\n    delete this.$renderers;\n}\n\nexport {destroy};\n","//import {fade} from 'systems/common/fade.js';\nimport {loadRenderers} from 'core/loadRenderers';\n\nfunction render() {\n    // console.log('render demo scene');\n\n    this.context.fillStyle = '#cbdbfc';\n    this.context.fillRect(0, 0, this.size.width, this.size.height);\n\n    //this.$world.system(['camera', 'fade'], fade);\n\n    loadRenderers.call(this,this.$renderers);\n\n    this.$camera.render();\n}\n\nexport {render};\n","function resize() {\n\n    console.log('resize demo scene');\n\n}\n\nexport {resize};\n","import {loadEntities} from 'core/loadEntities';\n\nfunction start() {\n\n    console.log('start demo scene');\n    var entities = loadEntities.call(this);\n    this.$world.add(entities);\n}\n\nexport {start};\n\n    //TODO :load start.json\n\n  /*  ??accèes start.json-> event qui envoie la reference this.$world\n    start.json\n    ??accèes entities->event  qui envoie this.$world.entities;\n    character.json\n    ??accèes model character.json->où est la ref?;\n    ??accèes model images.json->où est la ref?;\n    ??accèes aux sources images;\n    ??accèes aux sources datasets;\n    ??accèes nom de la scene courant et de toutes les scenes\n    ??accèes files update.json render.json start.json destroy.json\n    ??accèes liste des systems\n    ??start.json -> modify dans la console -> write in disk file\n    ??temp / history ??*/\n","import {loadSystems} from \"core/loadSystems\";\n\nfunction update() {\n\n    loadSystems.call(this,this.$systems);\n    this.$camera.position.x=()=>{return this.$world.entities.character.get('position').x+50};\n    this.$camera.update(this.delta.update);\n}\n\nexport {update};\n","function after() {\r\n\r\n}\r\n\r\nexport {after};\r\n","//import {inputs} from 'systems/common/inputs.js';\r\n\r\nfunction before() {\r\n\r\n    // console.log('lifecycle :', 'before demo scene');\r\n/*\r\n    this.$.controllers.inputs.forEach((input) => {\r\n\r\n        // console.log('debugging :', input);\r\n    });\r\n\r\n    this.$.world.system('inputs', ['inputs'], inputs);*/\r\n}\r\n\r\nexport {before};\r\n","function destroy() {\n\n    console.log('destroy loading scene');\n    console.log('-------');\n\n    delete this.state.redirect;\n    delete this.$systems;\n    delete this.$renderers;\n}\n\nexport {destroy};\n","import {loadRenderers} from 'core/loadRenderers';\n\nfunction render() {\n\n    // console.log('render loading scene');\n\n    loadRenderers.call(this,this.$renderers);\n\n    this.context.fillStyle = '#181a1f';\n    this.context.fillRect(0, 0, this.size.width, this.size.height);\n\n    this.context.font = '16px Courier New';\n    this.context.textAlign = 'start';\n    this.context.textBaseline = 'top';\n    this.context.fillStyle = '#6b717d';\n    this.context.fillText('/ Theatre', 8, 8);\n    this.context.fillStyle = '#d7dae0';\n\n    this.context.fillText('$ preloading assets...', 8, 32);\n\n    if (this.preloading === false) {\n\n        this.context.fillText('$ preloading completed', 8, 32 + 24);\n        this.context.fillText('$ loading demo scene...', 8, 32 + 24 + 24);\n    }\n}\n\nexport {render};\n","function resize() {\n\n    console.log('resize loading scene');\n}\n\nexport {resize};\n","import {getRenderers} from 'core/loadRenderers';\nimport {getSystems} from 'core/loadSystems';\n\nfunction setup() {\n\n    console.log('setup loading scene');\n    this.$renderers=getRenderers.call(this);\n    this.$systems=getSystems.call(this);\n}\n\nexport {setup};\n","function start() {\n\n    console.log('start loading scene');\n\n    this.state.redirect = false;\n}\n\nexport {start};\n","function update() {\n\n    // console.log('update loading scene');\n\n    if (this.preloading === false && this.state.redirect === false) {\n\n        setTimeout(() => {\n\n            this.load('demo');\n\n        }, 100);\n\n        this.state.redirect = true;\n    }\n}\n\nexport {update};\n","import * as Ease from './ease.js';\n\nfunction Camera(context, name, screen) {\n\n    let images = [];\n\n    let shaking = {\n\n        'current': false,\n        'duration': 0,\n        'easing': null,\n        'elapsed': 0,\n        'force': {\n\n            'x': 0,\n            'y': 0\n        },\n        'shift': {\n\n            'x': 0,\n            'y': 0\n        }\n    };\n\n    function add(image) {\n\n        let target = 0;\n\n        for (let iterator = images.length - 1; iterator >= 0; iterator -= 1) {\n\n            const current = images[iterator];\n\n            if (image.destination.z > current.destination.z\n            || image.destination.z === current.destination.z\n            && image.destination.y >= current.destination.y) {\n\n                target = iterator + 1;\n\n                break;\n            }\n        }\n\n        images.splice(target, 0, image);\n    }\n\n    function idle() {\n\n        this.shaking = {\n\n            'current': false,\n            'duration': 0,\n            'easing': null,\n            'elapsed': 0,\n            'force': {\n\n                'x': 0,\n                'y': 0\n            },\n            'shift': {\n\n                'x': 0,\n                'y': 0\n            }\n        };\n    }\n\n    function look(x, y) {\n\n        this.position.x = x;\n        this.position.y = y;\n    }\n\n    function render() {\n\n        images.forEach((image) => {\n\n            const {destination, frame, opacity, source} = image;\n\n            const visible = this.visible(\n\n                destination.x * this.screen.scale(),\n                destination.y * this.screen.scale(),\n                destination.width * this.screen.scale(),\n                destination.height * this.screen.scale()\n            );\n\n            if (opacity > 0\n            && visible === true) {\n\n                const alpha = context.globalAlpha;\n\n                context.globalAlpha = opacity;\n\n                const canvas = {\n\n                    'destination': {\n\n                        'x': this.screen.x() + destination.x * this.screen.scale() - (this.position.x() * this.screen.scale() - this.screen.width() / 2 + this.shaking.shift.x * this.screen.scale()),\n                        'y': this.screen.y() + destination.y * this.screen.scale() - (this.position.y() * this.screen.scale() - this.screen.height() / 2 + this.shaking.shift.y * this.screen.scale()),\n                        'width': destination.width * this.screen.scale(),\n                        'height': destination.height * this.screen.scale()\n                    }\n                };\n\n                const offset = {\n\n                    'top': Math.min(0, canvas.destination.y - this.screen.y()),\n                    'right': Math.max(0, canvas.destination.x + canvas.destination.width - (this.screen.x() + this.screen.width())),\n                    'bottom': Math.max(0, canvas.destination.y + canvas.destination.height - (this.screen.y() + this.screen.height())),\n                    'left': Math.min(0, canvas.destination.x - this.screen.x())\n                };\n\n                context.drawImage(\n\n                    source,\n                    frame.x - offset.left * (frame.width / canvas.destination.width),\n                    frame.y - offset.top * (frame.height / canvas.destination.height),\n                    frame.width - offset.right * (frame.width / canvas.destination.width) - Math.abs(offset.left * (frame.height / canvas.destination.height)),\n                    frame.height - offset.bottom * (frame.height / canvas.destination.height) - Math.abs(offset.top * (frame.height / canvas.destination.height)),\n                    canvas.destination.x - offset.left,\n                    canvas.destination.y - offset.top,\n                    canvas.destination.width - offset.right - Math.abs(offset.left),\n                    canvas.destination.height - offset.bottom - Math.abs(offset.top)\n                );\n\n                context.globalAlpha = alpha;\n            }\n        });\n\n        images = [];\n    }\n\n    function shake(x, y, duration, easing = Ease.reverse(Ease.easeOut(2))) {\n\n        this.idle();\n\n        this.shaking.force = {\n\n            'x': x,\n            'y': y\n        };\n\n        this.shaking.current = true;\n        this.shaking.duration = duration;\n        this.shaking.easing = easing;\n    }\n\n    function update(delta) {\n\n        if (this.shaking.current === false) {\n\n            return;\n        }\n\n        if (this.shaking.elapsed + delta >= this.shaking.duration) {\n\n            this.idle();\n\n            return;\n        }\n\n        this.shaking.elapsed += delta;\n\n        const amplitude = this.shaking.easing(this.shaking.elapsed / this.shaking.duration);\n        const angle = Math.random() * 2 * Math.PI;\n\n        this.shaking.shift.x = Math.round(Math.cos(angle) * this.shaking.force.x * amplitude);\n        this.shaking.shift.y = Math.round(Math.sin(angle) * this.shaking.force.y * amplitude);\n    }\n\n    function visible(x, y, width, height) {\n\n        const camera = {\n\n            'x': this.position.x() * this.screen.scale() - this.screen.width() / 2 + this.shaking.shift.x * this.screen.scale(),\n            'y': this.position.y() * this.screen.scale() - this.screen.height() / 2 + this.shaking.shift.y * this.screen.scale(),\n            'width': this.screen.width(),\n            'height': this.screen.height()\n        };\n\n        if (x + width <= camera.x\n        || x >= camera.x + camera.width\n        || y + height <= camera.y\n        || y >= camera.y + camera.height) {\n\n            return false;\n        }\n\n        return true;\n    }\n\n    this.name = name;\n\n    this.position = {\n\n        'x': () => 0,\n        'y': () => 0\n    };\n\n    this.screen = {\n\n        'x': screen.x,\n        'y': screen.y,\n        'width': screen.width,\n        'height': screen.height,\n        'scale': screen.scale\n    };\n\n    this.shaking = shaking;\n\n    this.add = add;\n    this.idle = idle;\n    this.look = look;\n    this.render = render;\n    this.shake = shake;\n    this.update = update;\n    this.visible = visible;\n}\n\n// exports current module as an object\nexport {Camera};\n","const keynames = [];\n\nkeynames[9] = 'TAB';\nkeynames[13] = 'ENTER';\nkeynames[16] = 'SHIFT';\nkeynames[17] = 'CTRL';\nkeynames[18] = 'ALT';\nkeynames[27] = 'ESC';\nkeynames[32] = 'SPACE';\n\nkeynames[37] = 'LEFT';\nkeynames[38] = 'UP';\nkeynames[39] = 'RIGHT';\nkeynames[40] = 'DOWN';\n\nkeynames[48] = 'ZERO';\nkeynames[49] = 'ONE';\nkeynames[50] = 'TWO';\nkeynames[51] = 'THREE';\nkeynames[52] = 'FOUR';\nkeynames[53] = 'FIVE';\nkeynames[54] = 'SIX';\nkeynames[55] = 'SEVEN';\nkeynames[56] = 'EIGHT';\nkeynames[57] = 'NINE';\n\nkeynames[65] = 'A';\nkeynames[66] = 'B';\nkeynames[67] = 'C';\nkeynames[68] = 'D';\nkeynames[69] = 'E';\nkeynames[70] = 'F';\nkeynames[71] = 'G';\nkeynames[72] = 'H';\nkeynames[73] = 'I';\nkeynames[74] = 'J';\nkeynames[75] = 'K';\nkeynames[76] = 'L';\nkeynames[77] = 'M';\nkeynames[78] = 'N';\nkeynames[79] = 'O';\nkeynames[80] = 'P';\nkeynames[81] = 'Q';\nkeynames[82] = 'R';\nkeynames[83] = 'S';\nkeynames[84] = 'T';\nkeynames[85] = 'U';\nkeynames[86] = 'V';\nkeynames[87] = 'W';\nkeynames[88] = 'X';\nkeynames[89] = 'Y';\nkeynames[90] = 'Z';\n\n// exports current module as an array\nexport {keynames};\n","import {keynames} from './keynames.js';\n\nfunction Keyboard(container, actions, inputs) {\n\n    const states = {};\n\n    function blur() {\n\n        for (let state in states) {\n\n            if (states.hasOwnProperty(state)\n            && states[state] === true) {\n\n                states[state] = false;\n\n                inputs.push({\n\n                    'type': 'KEYBOARD',\n                    'action': state,\n                    'state': 'UP'\n                });\n            }\n        }\n    }\n\n    function destroy() {\n\n        container.removeEventListener('blur', blur);\n        container.removeEventListener('keydown', keydown);\n        container.removeEventListener('keyup', keyup);\n    }\n\n    function keydown(event) {\n\n        const action = 'KEY_' + keynames[event.keyCode];\n\n        if (actions.indexOf(action) !== -1\n        && states[action] === false) {\n\n            event.preventDefault();\n\n            states[action] = true;\n\n            inputs.push({\n\n                'type': 'KEYBOARD',\n                'action': action,\n                'state': 'DOWN'\n            });\n        }\n    }\n\n    function keyup(event) {\n\n        const action = 'KEY_' + keynames[event.keyCode];\n\n        if (actions.indexOf(action) !== -1\n        && states[action] === true) {\n\n            event.preventDefault();\n\n            states[action] = false;\n\n            inputs.push({\n\n                'type': 'KEYBOARD',\n                'action': action,\n                'state': 'UP'\n            });\n        }\n    }\n\n    function setup() {\n\n        container.addEventListener('blur', blur);\n        container.addEventListener('keydown', keydown);\n        container.addEventListener('keyup', keyup);\n    }\n\n    actions.forEach((action) => {\n\n        states[action] = false;\n    });\n\n    setup.call(this);\n\n    this.destroy = destroy;\n    this.setup = setup;\n}\n\n// exports current module as an object\nexport {Keyboard};\n","function Mouse(container, actions, inputs) {\n\n    function contextmenu(event) {\n\n        const action = 'CLICK_RIGHT';\n\n        if (actions.indexOf(action) !== -1) {\n\n            event.preventDefault();\n        }\n    }\n\n    function destroy() {\n\n        container.removeEventListener('contextmenu', contextmenu);\n        container.removeEventListener('mousedown', mousedown);\n        container.removeEventListener('mouseenter', mouseenter);\n        container.removeEventListener('mouseleave', mouseleave);\n        container.removeEventListener('mousemove', mousemove);\n        container.removeEventListener('mouseup', mouseup);\n        container.removeEventListener('wheel', wheel);\n    }\n\n    function mousedown(event) {\n\n        const button = event.button;\n        const buttons = ['LEFT', 'MIDDLE', 'RIGHT'];\n\n        if (typeof buttons[button] === 'undefined') {\n\n            return;\n        }\n\n        const action = 'CLICK_' + buttons[button];\n\n        if (actions.indexOf(action) !== -1) {\n\n            event.preventDefault();\n\n            const rectangle = event.target.getBoundingClientRect();\n            const x = event.clientX - rectangle.left;\n            const y = event.clientY - rectangle.top;\n\n            inputs.push({\n\n                'type': 'MOUSE',\n                'action': action,\n                'state': 'DOWN',\n                'x': x,\n                'y': y\n            });\n        }\n    }\n\n    function mouseenter(event) {\n\n        const action = 'MOVE';\n\n        if (actions.indexOf(action) !== -1) {\n\n            event.preventDefault();\n\n            const rectangle = event.target.getBoundingClientRect();\n            const x = event.clientX - rectangle.left;\n            const y = event.clientY - rectangle.top;\n\n            inputs.push({\n\n                'type': 'MOUSE',\n                'action': action,\n                'state': 'ENTER',\n                'x': x,\n                'y': y\n            });\n        }\n    }\n\n    function mouseleave(event) {\n\n        const action = 'MOVE';\n\n        if (actions.indexOf(action) !== -1) {\n\n            event.preventDefault();\n\n            const rectangle = event.target.getBoundingClientRect();\n            const x = event.clientX - rectangle.left;\n            const y = event.clientY - rectangle.top;\n\n            inputs.push({\n\n                'type': 'MOUSE',\n                'action': action,\n                'state': 'LEAVE',\n                'x': x,\n                'y': y\n            });\n        }\n    }\n\n    function mousemove(event) {\n\n        const action = 'MOVE';\n\n        if (actions.indexOf(action) !== -1) {\n\n            event.preventDefault();\n\n            const rectangle = event.target.getBoundingClientRect();\n            const x = event.clientX - rectangle.left;\n            const y = event.clientY - rectangle.top;\n\n            inputs.push({\n\n                'type': 'MOUSE',\n                'action': action,\n                'x': x,\n                'y': y\n            });\n        }\n    }\n\n    function mouseup(event) {\n\n        const button = event.button;\n        const buttons = ['LEFT', 'MIDDLE', 'RIGHT'];\n\n        if (typeof buttons[button] === 'undefined') {\n\n            return;\n        }\n\n        const action = 'CLICK_' + buttons[button];\n\n        if (actions.indexOf(action) !== -1) {\n\n            event.preventDefault();\n\n            const rectangle = event.target.getBoundingClientRect();\n            const x = event.clientX - rectangle.left;\n            const y = event.clientY - rectangle.top;\n\n            inputs.push({\n\n                'type': 'MOUSE',\n                'action': action,\n                'state': 'UP',\n                'x': x,\n                'y': y\n            });\n        }\n    }\n\n    function setup() {\n\n        container.addEventListener('contextmenu', contextmenu);\n        container.addEventListener('mousedown', mousedown);\n        container.addEventListener('mouseenter', mouseenter);\n        container.addEventListener('mouseleave', mouseleave);\n        container.addEventListener('mousemove', mousemove);\n        container.addEventListener('mouseup', mouseup);\n        container.addEventListener('wheel', wheel);\n    }\n\n    function wheel(event) {\n\n        const action = 'SCROLL';\n\n        if (actions.indexOf(action) !== -1) {\n\n            event.preventDefault();\n\n            const rectangle = event.target.getBoundingClientRect();\n            const x = event.clientX - rectangle.left;\n            const y = event.clientY - rectangle.top;\n\n            let state;\n\n            if (Math.abs(event.deltaY) >= Math.abs(event.deltaX)) {\n\n                state = 'DOWN';\n\n                if (event.deltaY < 0) {\n\n                    state = 'UP';\n                }\n            }\n\n            else {\n\n                state = 'RIGHT';\n\n                if (event.deltaX < 0) {\n\n                    state = 'LEFT';\n                }\n            }\n\n            inputs.push({\n\n                'type': 'MOUSE',\n                'action': action,\n                'state': state,\n                'x': x,\n                'y': y\n            });\n        }\n    }\n\n    setup.call(this);\n\n    this.destroy = destroy;\n    this.setup = setup;\n}\n\n// exports current module as an object\nexport {Mouse};\n","import {Keyboard} from './keyboard.js';\nimport {Mouse} from './mouse.js';\n\nfunction Controllers(container, actions) {\n\n    const controllers = [];\n    const inputs = [];\n\n    function destroy() {\n\n        controllers.forEach((controller) => {\n\n            controller.destroy();\n        });\n    }\n\n    function setup() {\n\n        controllers.push(new Keyboard(container, actions, inputs));\n        controllers.push(new Mouse(container, actions, inputs));\n    }\n\n    setup.call(this);\n\n    this.destroy = destroy;\n    this.inputs = inputs;\n}\n\n// exports current module as an object\nexport {Controllers};\n","import {Camera} from 'modules/camera.js';\nimport {Controllers} from 'modules/controllers.js';\nimport {World} from 'modules/world.js';\nimport {getRenderers} from 'core/loadRenderers';\nimport {getSystems} from 'core/loadSystems';\nimport {generateDecor} from 'systems/demo/generateDecor'\n\nfunction setup() {\n\n    console.log('setup demo scene');\n\n    this.$origins = {\n        'default': {\n            'x': () => 0,\n            'y': () => -20,\n            'z': () => 0,\n            'scale': () => 1\n        }\n    };\n\n    this.$controllers = new Controllers(this.element, this.models.scenes[this.currentScene]['inputs']());\n    this.$world = new World(this);\n    this.$camera = new Camera(this.context ,'default',{\n        'x': () => 0,\n        'y': () => 0,\n        'width': () => this.size.width,\n        'height': () => this.size.height,\n        'scale': () => 3\n    });\n\n    this.$renderers=getRenderers.call(this);\n    this.$systems=getSystems.call(this);\n\n    generateDecor.call(this,{});\n\n}\n\nexport {setup};\n","var map = {\n\t\"./datasets/common/inputs.json\": [\n\t\t36,\n\t\t40\n\t],\n\t\"./images/common/placeholder-8x1.png\": [\n\t\t37,\n\t\t20\n\t],\n\t\"./images/demo/all-flappy-bird-16x16@1x.png\": [\n\t\t38,\n\t\t21\n\t],\n\t\"./images/demo/background-16x16@1x.png\": [\n\t\t39,\n\t\t22\n\t],\n\t\"./images/demo/best-48x16@1x.png\": [\n\t\t40,\n\t\t23\n\t],\n\t\"./images/demo/character-32x32.png\": [\n\t\t41,\n\t\t24\n\t],\n\t\"./images/demo/clouds-160x16@1x.png\": [\n\t\t42,\n\t\t25\n\t],\n\t\"./images/demo/flappy-bird-16x16@1x.png\": [\n\t\t43,\n\t\t26\n\t],\n\t\"./images/demo/flappy-bird-shadow-16x8@1x.png\": [\n\t\t44,\n\t\t27\n\t],\n\t\"./images/demo/foreground-16x16@1x.png\": [\n\t\t45,\n\t\t28\n\t],\n\t\"./images/demo/game-over-64x64@1x.png\": [\n\t\t46,\n\t\t29\n\t],\n\t\"./images/demo/numbers-8x16@1x.png\": [\n\t\t47,\n\t\t30\n\t],\n\t\"./images/demo/numbers-blue-8x16@1x.png\": [\n\t\t48,\n\t\t31\n\t],\n\t\"./images/demo/pipe-16x16@1x.png\": [\n\t\t49,\n\t\t32\n\t],\n\t\"./images/demo/pipe-shadow-16x8@1x.png\": [\n\t\t50,\n\t\t33\n\t],\n\t\"./images/demo/touch-screen-64x32@1x.png\": [\n\t\t51,\n\t\t34\n\t],\n\t\"./images/demo/waves-16x16@1x.png\": [\n\t\t52,\n\t\t35\n\t],\n\t\"./sounds/demo/explode.mp3\": [\n\t\t53,\n\t\t36\n\t],\n\t\"./sounds/demo/jump.mp3\": [\n\t\t54,\n\t\t37\n\t],\n\t\"./spritesheets/common/character-32x32.png\": [\n\t\t55,\n\t\t38\n\t],\n\t\"./spritesheets/common/spritesheet.png\": [\n\t\t56,\n\t\t39\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 30;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./components/common/camera.json\": [\n\t\t57,\n\t\t41\n\t],\n\t\"./components/common/commands.json\": [\n\t\t58,\n\t\t42\n\t],\n\t\"./components/common/fade.json\": [\n\t\t59,\n\t\t43\n\t],\n\t\"./components/common/forces.json\": [\n\t\t60,\n\t\t44\n\t],\n\t\"./components/common/hitbox.json\": [\n\t\t61,\n\t\t45\n\t],\n\t\"./components/common/images.json\": [\n\t\t62,\n\t\t46\n\t],\n\t\"./components/common/inputs.json\": [\n\t\t63,\n\t\t47\n\t],\n\t\"./components/common/origin.json\": [\n\t\t64,\n\t\t48\n\t],\n\t\"./components/common/position.json\": [\n\t\t65,\n\t\t49\n\t],\n\t\"./components/demo/decor.json\": [\n\t\t66,\n\t\t50\n\t],\n\t\"./components/demo/player.json\": [\n\t\t67,\n\t\t51\n\t],\n\t\"./entities/demo/background.json\": [\n\t\t7\n\t],\n\t\"./entities/demo/bottom.json\": [\n\t\t5\n\t],\n\t\"./entities/demo/character.json\": [\n\t\t68,\n\t\t52\n\t],\n\t\"./entities/demo/pipeBottom.json\": [\n\t\t9\n\t],\n\t\"./entities/demo/pipeTop.json\": [\n\t\t8\n\t],\n\t\"./entities/demo/top.json\": [\n\t\t4\n\t],\n\t\"./entities/demo/water.json\": [\n\t\t6\n\t],\n\t\"./scenes/demo/entities.json\": [\n\t\t69,\n\t\t53\n\t],\n\t\"./scenes/demo/inputs.json\": [\n\t\t70,\n\t\t54\n\t],\n\t\"./scenes/demo/renderers.json\": [\n\t\t71,\n\t\t55\n\t],\n\t\"./scenes/demo/systems.json\": [\n\t\t72,\n\t\t56\n\t],\n\t\"./snippets/demo/ease-in.js\": [\n\t\t73,\n\t\t1\n\t],\n\t\"./snippets/demo/ease-linear.js\": [\n\t\t74,\n\t\t2\n\t],\n\t\"./snippets/demo/ease-out.js\": [\n\t\t75,\n\t\t3\n\t],\n\t\"./snippets/demo/fade-ending.js\": [\n\t\t76,\n\t\t4\n\t],\n\t\"./snippets/demo/forces-down.js\": [\n\t\t77,\n\t\t5\n\t],\n\t\"./snippets/demo/forces-ending.js\": [\n\t\t78,\n\t\t6\n\t],\n\t\"./snippets/demo/forces-handling.js\": [\n\t\t79,\n\t\t7\n\t],\n\t\"./snippets/demo/forces-water-left.js\": [\n\t\t80,\n\t\t8\n\t],\n\t\"./snippets/demo/forces-water-right.js\": [\n\t\t81,\n\t\t9\n\t],\n\t\"./snippets/demo/handle-hitbox.js\": [\n\t\t82,\n\t\t10\n\t],\n\t\"./snippets/demo/timeout-ending.js\": [\n\t\t83,\n\t\t11\n\t],\n\t\"./systems/common/fade.js\": [\n\t\t84,\n\t\t12\n\t],\n\t\"./systems/common/forces.js\": [\n\t\t85,\n\t\t13\n\t],\n\t\"./systems/common/hitbox.js\": [\n\t\t91,\n\t\t14\n\t],\n\t\"./systems/common/images.js\": [\n\t\t86,\n\t\t15\n\t],\n\t\"./systems/common/inputs.js\": [\n\t\t87,\n\t\t16\n\t],\n\t\"./systems/common/spritesheets.js\": [\n\t\t88,\n\t\t17\n\t],\n\t\"./systems/demo/commands.js\": [\n\t\t89,\n\t\t18\n\t],\n\t\"./systems/demo/generateDecor.js\": [\n\t\t11\n\t],\n\t\"./systems/demo/move.js\": [\n\t\t90,\n\t\t19\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 31;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./demo/index.js\": 33,\n\t\"./loading/index.js\": 34\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 32;","import {after} from './after.js';\nimport {before} from './before.js';\nimport {destroy} from './destroy.js';\nimport {render} from './render.js';\nimport {resize} from './resize.js';\nimport {setup} from './setup.js';\nimport {start} from './start.js';\nimport {update} from './update.js';\n\nif (typeof module.hot !== 'undefined') {\n\n    module.hot.accept([\n\n        './after.js',\n        './before.js',\n        './destroy.js',\n        './render.js',\n        './resize.js',\n        './setup.js',\n        './start.js',\n        './update.js'\n    ]);\n}\n\nexport {after, before, destroy, render, resize, setup, start, update};\n","import {after} from './after.js';\nimport {before} from './before.js';\nimport {destroy} from './destroy.js';\nimport {render} from './render.js';\nimport {resize} from './resize.js';\nimport {setup} from './setup.js';\nimport {start} from './start.js';\nimport {update} from './update.js';\n\nif (typeof module.hot !== 'undefined') {\n\n    module.hot.accept([\n\n        './after.js',\n        './before.js',\n        './destroy.js',\n        './render.js',\n        './resize.js',\n        './setup.js',\n        './start.js',\n        './update.js'\n    ]);\n}\n\nexport {after, before, destroy, render, resize, setup, start, update};\n","function Canvas(type, identifier, width, height, pixelated = false) {\n\n    const element = document.createElement('canvas');\n    const context = element.getContext(type);\n\n    function focus() {\n\n        element.setAttribute('tabindex', 0);\n        element.focus();\n    }\n\n    function resize(width, height) {\n\n        let ratio = window.devicePixelRatio || 1;\n\n        if (pixelated === true) {\n\n            ratio = Math.floor(ratio);\n        }\n\n        element.setAttribute('height', ratio * height);\n        element.setAttribute('width', ratio * width);\n\n        element.style.height = '100%';\n        element.style.width = '100%';\n\n        context.scale(ratio, ratio);\n\n        if (pixelated === true) {\n\n            sharp();\n        }\n    }\n\n    function sharp() {\n\n        element.style.imageRendering = '-moz-crisp-edges';\n        element.style.imageRendering = '-webkit-crisp-edges';\n        element.style.imageRendering = 'crisp-edges';\n        element.style.imageRendering = 'pixelated';\n        context.imageSmoothingEnabled = false;\n    }\n\n    element.setAttribute('id', identifier);\n    element.addEventListener('mousedown', focus);\n\n    resize(width, height);\n\n    this.context = context;\n    this.element = element;\n    this.focus = focus;\n    this.resize = resize;\n}\n\n// exports current module as an object\nexport {Canvas};\n","function Loop(handler, framerate = 60, speed = 1) {\n\n    let elapsedTime = 0;\n    let lastUpdate = null;\n    let paused = false;\n\n    function update() {\n\n        const currentUpdate = performance.now();\n\n        if (lastUpdate !== null\n        && paused === false) {\n\n            // define elapsed time since last update\n            elapsedTime += currentUpdate - lastUpdate;\n\n            // call user's update handler matching timeframe, speed and fixing browser time handling\n            while (elapsedTime >= 1000 / this.framerate / this.speed\n            && paused === false) {\n\n                // define elapsed time since last user's update handler matching timeframe and speed\n                elapsedTime -= 1000 / this.framerate / this.speed;\n\n                handler(1000 / this.framerate);\n            }\n        }\n\n        // call user's update handler on each available frame\n        requestAnimationFrame(this.update.bind(this));\n\n        lastUpdate = currentUpdate;\n    }\n\n    function pause() {\n\n        paused = true;\n    }\n\n    function play() {\n\n        paused = false;\n    }\n\n    function tick(times = 1) {\n\n        // call user's update handler on each available frame\n        requestAnimationFrame(() => {\n\n            while (times--) {\n\n                handler(1000 / this.framerate);\n            }\n        });\n    }\n\n    this.framerate = framerate;\n    this.speed = speed;\n\n    this.pause = pause;\n    this.play = play;\n    this.tick = tick;\n    this.update = update;\n}\n\n// exports current module as an object\nexport {Loop};\n","const preloadAssets = function() {\r\n  return new Promise((resolve, reject) => {\r\n\r\n    const context = require.context('assets/', true, /^.\\/.+\\.[a-zA-Z0-9]+$/, 'lazy');\r\n\r\n    let promiseArray = [];\r\n\r\n    this.assetsLoaded=[];\r\n    context.keys().forEach((key) => {\r\n\r\n        let promise = new Promise((resolve, reject) => {\r\n            context(key).then((module) => {\r\n\r\n                var assetLoaded = this.assetsLoaded.find((asset) => {\r\n                    return asset.key == key\r\n                })\r\n\r\n                if ((assetLoaded && assetLoaded.source != module) || assetLoaded === undefined) {\r\n\r\n                    if (assetLoaded !== undefined && assetLoaded.source != module) {\r\n                        let index = this.assetsLoaded.indexOf(assetLoaded)\r\n                        if (index > -1) {\r\n                            this.assetsLoaded.splice(index, 1);\r\n                        }\r\n                    }\r\n\r\n                    loadAsset(key, module).then((asset) => {\r\n\r\n                        this.assetsLoaded.push(asset);\r\n\r\n                        if (typeof this.assets[asset.type + 's'] === 'undefined') {\r\n\r\n                            this.assets[asset.type + 's'] = {};\r\n                        }\r\n\r\n                        if (typeof this.assets[asset.type + 's'][asset.scope] === 'undefined') {\r\n\r\n                            this.assets[asset.type + 's'][asset.scope] = {};\r\n                        }\r\n\r\n                        this.assets[asset.type + 's'][asset.scope][asset.name] = asset.getter;\r\n\r\n                    });\r\n\r\n                }\r\n                resolve(module);\r\n            });\r\n        });\r\n        promiseArray.push(promise);\r\n    });\r\n\r\n    Promise.all(promiseArray).then((modules) => {\r\n        if (module.hot) {\r\n          /*  module.hot.dispose(context.id, (contextId) => {\r\n                preloadAssets.call(this);\r\n            });*/\r\n            module.hot.accept(context.id, (contextId) => {\r\n                preloadAssets.call(this);\r\n            });\r\n        }\r\n        resolve()\r\n    });\r\n\r\n  });\r\n}\r\n\r\nfunction loadAsset(key,module) {\r\n\r\n    // creates a promise for current asset preloading\r\n    return new Promise(function (resolve, reject) {\r\n\r\n        console.log(\"load assets or reload\")\r\n\r\n        const [type, scope, name] = key.match(/(?!\\.\\/|\\/)(.+?)(?=(?:\\.[^\\.\\/]+$)|\\/)/g);\r\n\r\n        const asset = {\r\n            'key': key,\r\n            'name': name,\r\n            'scope': scope,\r\n            'source': module,\r\n            'type': type.substring(0, type.length - 1)\r\n        };\r\n\r\n\r\n        // if current asset is a dataset then preload it\r\n        if (asset.type === 'dataset') {\r\n\r\n            asset.getter = () => asset.source;\r\n\r\n            resolve(asset);\r\n        }\r\n\r\n        // if current asset is an image then preload it\r\n        if (asset.type === 'image' || asset.type === 'spritesheet') {\r\n\r\n            const image = new Image();\r\n\r\n            image.src =  asset.source;\r\n\r\n            // when current image is loaded then resolve current promise\r\n            image.onload = function () {\r\n\r\n                asset.getter = () => image;\r\n\r\n                resolve(asset);\r\n            };\r\n        }\r\n\r\n        // if current asset is a sound then preload it\r\n        else if (asset.type === 'sound') {\r\n\r\n            const sound = new Audio(asset.source);\r\n\r\n            // when current sound is loaded then resolve current promise\r\n            sound.oncanplaythrough = function () {\r\n\r\n                asset.getter = () => sound.cloneNode();\r\n\r\n                resolve(asset);\r\n            };\r\n        }\r\n    });\r\n\r\n}\r\n\r\n\r\nexport {preloadAssets}\r\n","const preloadModels = function() {\r\n\r\n return new Promise((resolve, reject) => {\r\n    const context = require.context('models/', true, /^.\\/.+\\.[a-zA-Z0-9]+$/, 'lazy');\r\n\r\n    let promiseArray = [];\r\n\r\n    this.modelsLoaded=[];\r\n    context.keys().forEach((key) => {\r\n\r\n        let promise = new Promise((resolve, reject) => {\r\n            context(key).then((module) => {\r\n\r\n                var componentLoaded = this.modelsLoaded.find((component) => {\r\n                    return component.key == key\r\n                })\r\n\r\n                if ((componentLoaded && componentLoaded.source != module) || componentLoaded === undefined) {\r\n\r\n                    if (componentLoaded !== undefined && componentLoaded.source != module) {\r\n                        let index = this.modelsLoaded.indexOf(componentLoaded)\r\n                        if (index > -1) {\r\n                            this.modelsLoaded.splice(index, 1);\r\n                        }\r\n                    }\r\n\r\n                    loadModel.call(this,key, module).then((component) => {\r\n\r\n                        this.modelsLoaded.push(component);\r\n\r\n                        if (typeof this.models[component.type + 's'] === 'undefined') {\r\n\r\n                            this.models[component.type + 's'] = {};\r\n                        }\r\n\r\n                        if (typeof this.models[component.type + 's'][component.scope] === 'undefined') {\r\n\r\n                            this.models[component.type + 's'][component.scope] = {};\r\n                        }\r\n\r\n                        this.models[component.type + 's'][component.scope][component.name] = component.getter;\r\n\r\n                    });\r\n\r\n                }\r\n                resolve(module);\r\n            });\r\n        });\r\n        promiseArray.push(promise);\r\n    });\r\n\r\n    Promise.all(promiseArray).then((modules) => {\r\n        if (module.hot) {\r\n          /*  module.hot.dispose(context.id, (contextId) => {\r\n                preloadModels.call(this);\r\n            });*/\r\n            module.hot.accept(context.id, (contextId) => {\r\n                preloadModels.call(this);\r\n            });\r\n        }\r\n        resolve()\r\n    });\r\n  });\r\n}\r\n\r\nfunction loadModel(key,module) {\r\n\r\n    // creates a promise for current asset preloading\r\n    return new Promise((resolve, reject)=> {\r\n\r\n        console.log(\"load models or reload\")\r\n\r\n        const [type, scope, name] = key.match(/(?!\\.\\/|\\/)(.+?)(?=(?:\\.[^\\.\\/]+$)|\\/)/g);\r\n\r\n        const asset = {\r\n            'key': key,\r\n            'name': name,\r\n            'scope': scope,\r\n            'source': module,\r\n            'type': type.substring(0, type.length - 1)\r\n        };\r\n\r\n\r\n        if (type === 'snippets') {\r\n            asset.getter = asset.source.default.bind(this);\r\n            resolve(asset);\r\n        }else{\r\n          asset.getter = () => asset.source;\r\n        }\r\n\r\n          resolve(asset);\r\n\r\n    });\r\n\r\n}\r\nexport {preloadModels}\r\n","const preloadScenes =function() {\r\n\r\n    const context = require.context('scenes/', true, /^\\.\\/[^\\/]+\\/index\\.js$/, 'sync');\r\n\r\n    context.keys().forEach((key) => {\r\n\r\n        const name = key.match(/^\\.\\/([^\\/]+)\\/index\\.js$/)[1];\r\n\r\n        this.scenes[name] = context(key);\r\n    });\r\n}\r\n\r\nexport {preloadScenes};\r\n","import {Theatre} from 'core/theatre.js';\n\nvar container = document.body.querySelector('.theatre-container');\n\nnew Theatre({\n    'container': container,\n    'expose': true,\n    'sharp': true\n});\n","//import * as scenes from 'scenes/index.js';\nimport {Canvas} from 'core/canvas.js';\nimport {Loop} from 'core/loop.js';\n\nimport {preloadAssets} from 'core/preloadAssets.js';\nimport {preloadModels} from 'core/preloadModels.js';\nimport {preloadScenes} from 'core/preloadScenes.js';\n\nfunction Theatre(config) {\n\n    const {container} = config;\n\n    const expose = config.expose || false;\n    const framerate = config.framerate || 60;\n    const sharp = config.sharp || false;\n    const speed = config.speed || 1;\n\n    const size = {\n        'height': container.offsetHeight,\n        'width': container.offsetWidth\n    };\n\n\n    let canvas = null;\n    let loading = null;\n    let restarting = false;\n    let updates = 0;\n\n\n        function forward(timeframe) {\n\n            this.delta = timeframe;\n\n            if (container.offsetWidth !== this.size.width\n            || container.offsetHeight !== this.size.height) {\n\n                resize.call(this);\n            }\n\n            if (this.playing === true) {\n\n                this.tick();\n            }\n\n            this.scene.before.call(this);\n\n            if (updates > 0) {\n\n                update.call(this);\n            }\n\n            this.scene.render.call(this);\n            this.scene.after.call(this);\n        }\n\n\n    function initialize() {\n\n        canvas = new Canvas('2d', 'theatre', this.size.width, this.size.height, sharp);\n\n        container.appendChild(canvas.element);\n\n        canvas.focus();\n\n        this.container = container;\n        this.context = canvas.context;\n        this.element = canvas.element;\n        this.models= {};\n        this.assets = {};\n        this.delta = 0;\n\n        this.loop = new Loop(forward.bind(this), framerate, speed);\n        var promisePreloadAssets=preloadAssets.call(this);\n        var promisePreloadModels=preloadModels.call(this);\n        preloadScenes.call(this);\n\n        Promise.all([promisePreloadAssets,promisePreloadModels]).then((modules) => {\n          this.preloading=false;\n        });\n\n\n/*        assets.call(this);\n        components.call(this);\n        snippets.call(this);\n        scenes.call(this);*/\n\n        this.scene = this.scenes.loading;\n        this.scene.setup.call(this);\n        this.scene.start.call(this);\n\n        this.loop.update();\n    }\n\n\n        function load(scene) {\n\n            loading = scene;\n        }\n\n        function pause() {\n\n            this.playing = false;\n        }\n\n        function play() {\n\n            this.playing = true;\n        }\n\n        function resize() {\n\n            this.size.width = container.offsetWidth;\n            this.size.height = container.offsetHeight;\n\n            canvas.resize(this.size.width, this.size.height);\n\n            this.scene.resize.call(this);\n        }\n\n        function restart() {\n\n            restarting = true;\n        }\n\n\n\n    function tick(times = 1) {\n\n        updates += times;\n    }\n\n    function update() {\n\n        while (updates > 0) {\n\n            this.scene.update.call(this);\n\n            updates -= 1;\n\n            if (restarting === true) {\n\n                this.scene.start.call(this);\n\n                restarting = false;\n\n                continue;\n            }\n\n            if (loading !== null) {\n\n                this.scene.destroy.call(this);\n                this.scene = this.scenes[loading];\n                this.currentScene=loading;\n                this.scene.setup.call(this);\n                this.scene.start.call(this);\n\n                loading = null;\n\n                continue;\n            }\n        }\n    }\n\n    this.playing = true;\n    this.preloading = true;\n    this.currentScene;\n    this.$={};\n    this.scenes = {};\n    this.size = size;\n    this.snippets = {};\n    this.state = {};\n    this.version = '0.39.0';\n\n    this.load = load;\n    this.pause = pause;\n    this.play = play;\n    this.restart = restart;\n    this.tick = tick;\n\n    initialize.call(this, config);\n\n    if (expose === true) {\n\n        window.theatre = this;\n    }\n}\n\n// exports current module as an object\nexport {\n    Theatre\n};\n"],"sourceRoot":""}