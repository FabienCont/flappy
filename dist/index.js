!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=18)}([function(t,e,n){"use strict";function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,r=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){r=!0,s=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw s}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(t,e){this.components={},this.name=t,this.add=function(t){var e=this;!1===Array.isArray(t)&&(t=[t]),t.forEach(function(t){e.components[t.name]=t})},this.get=function(t){return this.components[t]},this.has=function(t){!1===Array.isArray(t)&&(t=[t]);for(var e=0,n=t.length;e<n;e+=1){var i=t[e],r=i.replace("not:",""),s=i!==r;if(this.components.hasOwnProperty(r)===s)return!1}return!0},this.remove=function(t){!1===Array.isArray(t)&&(t=[t]);for(var e=0,n=t.length;e<n;e+=1){var i=t[e];!0===this.components.hasOwnProperty(i)&&delete this.components[i]}},this.add(e)}function s(t){this.entities={},this.add=function(t){var e=this;!1===Array.isArray(t)&&(t=[t]),t.forEach(function(t){e.entities[t.name]=t})},this.get=function(t){return this.entities[t]},this.remove=function(t){!1===Array.isArray(t)&&(t=[t]);for(var e=0,n=t.length;e<n;e+=1){var i=t[e],r=i.name||i;!0===this.entities.hasOwnProperty(r)&&delete this.entities[r]}},this.system=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.entities,s={};Object.entries(r).forEach(function(t){var n=i(t,2),r=n[0],o=n[1];!0===o.has(e)&&(s[r]=o)}),n.call(t,s)}}n.d(e,"b",function(){return s}),n.d(e,"a",function(){return r})},function(t,e,n){"use strict";n.r(e),function(t){var i=n(3);n.d(e,"destroy",function(){return i.a});var r=n(4);n.d(e,"render",function(){return r.a});var s=n(5);n.d(e,"resize",function(){return s.a});var o=n(6);n.d(e,"setup",function(){return o.a});var a=n(7);n.d(e,"start",function(){return a.a});var c=n(8);n.d(e,"update",function(){return c.a}),void 0!==t.hot&&t.hot.accept(["./destroy.js","./render.js","./resize.js","./setup.js","./start.js","./update.js"])}.call(this,n(2)(t))},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,n){"use strict";function i(){console.log("destroy loading scene"),console.log("-------"),delete this.state.redirect}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function i(){this.context.fillStyle="#181a1f",this.context.fillRect(0,0,this.size.width,this.size.height),this.context.font="16px Courier New",this.context.textAlign="start",this.context.textBaseline="top",this.context.fillStyle="#6b717d",this.context.fillText("/ Theatre",8,8),this.context.fillStyle="#d7dae0",this.context.fillText("$ preloading assets...",8,32),!1===this.preloading&&(this.context.fillText("$ preloading completed",8,56),this.context.fillText("$ loading demo scene...",8,80))}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function i(){console.log("resize loading scene")}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function i(){console.log("setup loading scene")}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function i(){console.log("start loading scene"),this.state.redirect=!1}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function i(){var t=this;!1===this.preloading&&!1===this.state.redirect&&(setTimeout(function(){t.load("demo")},3e3),this.state.redirect=!0)}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";n.r(e),function(t){var i=n(10);n.d(e,"destroy",function(){return i.a});var r=n(13);n.d(e,"render",function(){return r.a});var s=n(11);n.d(e,"resize",function(){return s.a});var o=n(14);n.d(e,"setup",function(){return o.a});var a=n(12);n.d(e,"start",function(){return a.a});var c=n(15);n.d(e,"update",function(){return c.a}),void 0!==t.hot&&t.hot.accept(["./destroy.js","./render.js","./resize.js","./setup.js","./start.js","./update.js"])}.call(this,n(2)(t))},function(t,e,n){"use strict";function i(){console.log("destroy demo scene"),console.log("-------"),delete this.$camera,delete this.$origins,delete this.$world}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function i(){console.log("resize demo scene"),this.$camera.size.height=this.size.height,this.$camera.size.width=this.size.width,this.$origins.default.x=this.size.width/2,this.$origins.default.y=this.size.height/2}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";var i=n(0);function r(){console.log("start demo scene"),this.$world.add(function(){return new i.a("theatre",[new function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.name="camera",this.camera=t,this.opacity=e}(this.$camera),new function(t){this.name="images",this.parts=t,this.parts.forEach(function(t){var e=t.destination,n=t.frame,i=t.framerate,r=t.frames,s=t.opacity,o=t.source;t.source=o,t.frames=r||[[0,0,32,32]],t.frame=n||0,t.framerate=i||8,t.destination=e||[0,0,0,32,32],t.opacity=s||1,t.elapsed=0})}([{source:this.assets.images.common.theatre(),frames:[[0,0,32,32],[1,0,32,32],[2,0,32,32],[3,0,32,32],[4,0,32,32],[5,0,32,32],[6,0,32,32],[7,0,32,32]],frame:0,destination:[0,0,0,64,64]}]),new function(t){this.name="origin",this.reference=t}(this.$origins.default),new function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.name="position",this.x=t,this.y=e,this.z=n}(-32,-32,0)])}.call(this))}n.d(e,"a",function(){return r})},function(t,e,n){"use strict";function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,r=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){r=!0,s=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw s}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(t){var e=this;Object.entries(t).forEach(function(t){var n=i(t,2),r=(n[0],n[1]),s=r.get("camera"),o=r.get("fade");null===o.fade&&(o.fade=o.opacity-s.opacity);var a=o.duration-o.elapsed,c=e.delta.update>a?a:e.delta.update,u=(o.elapsed+c)/o.duration,f=o.fade*o.easing(u);s.opacity+=f-o.faded,o.faded=f,o.elapsed+=c,o.elapsed>=o.duration&&"function"==typeof o.ending&&o.ending(r,e.delta.update-c)})}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,r=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){r=!0,s=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw s}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(t){var e=this;Object.entries(t).forEach(function(t){var n=s(t,2),i=(n[0],n[1]),r=i.get("camera"),o=i.get("images"),a=i.get("origin"),c=i.get("position");o.parts.forEach(function(t){var n=t.destination,i=t.framerate,o=t.frames,u=t.opacity,f=t.source;if(o.length>1){t.elapsed+=e.delta.update;for(var h=1e3/i;t.elapsed>=h;)t.elapsed-=h,t.frame=t.frame===o.length-1?0:t.frame+1}var d=s(o[t.frame],4),l=d[0],p=d[1],g=d[2],y=d[3];void 0===f&&(f=e.assets.images.common.placeholder(),l%=8,p%=1,g=1,y=1),r.camera.add({source:f,frame:{x:g*l,y:y*p,width:g,height:y},destination:{x:Math.floor((c.x+n[0])*a.reference.scale+a.reference.x),y:Math.floor((c.y+n[1])*a.reference.scale+a.reference.y),z:Math.floor(c.z+n[2]+a.reference.z),width:n[3]*a.reference.scale,height:n[4]*a.reference.scale},opacity:r.opacity*u})})})}function a(){this.context.fillStyle="#cbdbfc",this.context.fillRect(0,0,this.size.width,this.size.height),this.$world.system(["camera","fade"],r),this.$world.system(["camera","images","origin","position"],o),this.$camera.render()}n.d(e,"a",function(){return a})},function(t,e,n){"use strict";function i(t){return function(e){return Math.pow(e,t)}}function r(t){return function(e){return 1-i(t)(1-e)}}var s=n(0);function o(){console.log("setup demo scene"),this.$camera=new function(t,e,n){var i=[],s={current:!1,duration:0,easing:null,elapsed:0,force:{x:0,y:0},shift:{x:0,y:0}};this.position={x:0,y:0},this.size={width:e,height:n},this.add=function(t){for(var e=0,n=i.length-1;n>=0;n-=1){var r=i[n];if(t.destination.z>r.destination.z||t.destination.z===r.destination.z&&t.destination.y>=r.destination.y){e=n+1;break}}i.splice(e,0,t)},this.idle=function(){s={current:!1,duration:0,easing:null,elapsed:0,force:{x:0,y:0},shift:{x:0,y:0}}},this.render=function(){var e=this;i.forEach(function(n){var i=n.destination,r=n.frame,o=n.opacity,a=n.source;if(o>0&&!0===e.visible(i.x,i.y,i.width,i.height)){var c=t.globalAlpha;t.globalAlpha=o,t.drawImage(a,r.x,r.y,r.width,r.height,i.x-(e.position.x+s.shift.x),i.y-(e.position.y+s.shift.y),i.width,i.height),t.globalAlpha=c}}),i=[]},this.set=function(t,e){this.position.x=t,this.position.y=e},this.shake=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return function(e){return t(1-e)}}(r(2));this.idle(),s.force={x:t,y:e},s.current=!0,s.duration=n,s.easing=i},this.update=function(t){if(!1!==s.current)if(s.elapsed+t>=s.duration)this.idle();else{s.elapsed+=t;var e=s.easing(s.elapsed/s.duration),n=2*Math.random()*Math.PI;s.shift.x=Math.round(Math.cos(n)*s.force.x*e),s.shift.y=Math.round(Math.sin(n)*s.force.y*e)}},this.visible=function(t,e,n,i){var r=this.position.x+s.shift.x,o=this.position.y+s.shift.y,a=this.size.width,c=this.size.height;return!(t+n<=r||t>=r+a||e+i<=o||e>=o+c)}}(this.context,this.size.width,this.size.height),this.$world=new s.b(this),this.$origins={default:{x:this.size.width/2,y:this.size.height/2,z:0,scale:1}}}n.d(e,"a",function(){return o})},function(t,e,n){"use strict";function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,r=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){r=!0,s=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw s}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(t){var e=this;Object.entries(t).forEach(function(t){var n=i(t,2),r=(n[0],n[1]),s=r.get("forces"),o=r.get("position"),a=[];s.parts.forEach(function(t){var n=!1===t.ending,i=t.duration-t.elapsed,s=!1===n&&e.delta.update>i?i:e.delta.update,c=(t.elapsed+s)/t.duration,u={x:t.x*t.easing(c),y:t.y*t.easing(c)};if(o.x+=u.x-t.moved.x,o.y+=u.y-t.moved.y,t.moved=u,t.elapsed+=e.delta.update,"function"==typeof t.handling){t.handling(r,t.moved.x,t.moved.y,t.elapsed,function(){a.push(t)})}t.elapsed>=t.duration&&"function"==typeof t.ending&&-1===a.indexOf(t)&&(t.ending(r,t.moved.x,t.moved.y,t.elapsed),a.push(t))}),s.parts=s.parts.filter(function(t){return-1===a.indexOf(t)})})}function s(){this.$world.system(["position","forces"],r),this.$camera.update(this.delta.update)}n.d(e,"a",function(){return s})},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAABCAYAAADjAO9DAAAAKklEQVQImWP8/cns/711Bgzbtl1l2HaJkeHujx8MsvIODDL6uQws8cwMABZTDRH5GFXJAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAgCAYAAAD9qabkAAACQklEQVR4nO3cP0sCYRzA8Z9hYEu0FRRqLU0SSEMODQ2tEsjRS2gJegFFU72AoKWXECJEa2NDQSFEU0v/UKhNmgIFG+SeLvSO57meu0v7fiftHp7PWflLT0iEiIiIiIiIiIiIiIhGs5TuwoX8ctdk48fnW+298fHxk/G1Fi3kl7unF9dy/PGmhW9Pzsjm+oq1bwI+Pn40flr3JI4/3uR+x1H3W432j+NTc+Pfa4+quttqh4+Pb9/XHgBuW6fTgcdPNt9Nt8THx0/I1x4A6fqsun338DxwzdJivm+trbx7nh88Sc7pf3UTpy8ifefwX/2Xau/taXlvHn/I/DHdhZ1iU1qNtu+TX6Q3GFqNtnSKTe0TCOMPevLjJ+fnnJTknFSijx8/nK89AEymStQT8C/4fk/CuHxba0fBzzkp9VcQP6JXAER/uaCBTP4xAIawl2o30V94/J9+3Odj0zcaAN6PGn6zJmz4vb2Dftj48fve+8PmG38MeL0/0fcZZFg8TPj4+PZ8owFQOKpKuj7re5VRHasbnwc+Pn4CvtEAcK8uBl1ljOIKKD4+fjS+8UXATrHpO4GCjtkKHx/fnm/0CqBTbMplZUNERFZrZ2rauKh7bG33xugk8PHxk/G1B8Dn/atcHVbU/cvKhoJcuFSuqbW2w8fHt+8bvQVwgUG3S+WaZApZyRSyJlsahY+Pb9c3eguQKWSlJDV12/t1tyimHz4+fjS+0QDwbh7lA8XHx4/H51+C4ePjExERERERERERERHRyPUFyufFwDEB8/YAAAAASUVORK5CYII="},function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"loading",function(){return a}),n.d(i,"demo",function(){return c});var r=[{name:"placeholder",scope:"common",source:n(16),type:"image"},{name:"theatre",scope:"common",source:n(17),type:"image"}];function s(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o=[].concat(s([]),s(r),s([])),a=n(1),c=n(9);function u(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=document.createElement("canvas"),o=s.getContext(t);function a(t,e){var n=window.devicePixelRatio||1;!0===r&&(n=Math.floor(n)),s.setAttribute("height",n*e),s.setAttribute("width",n*t),s.style.height=e+"px",s.style.width=t+"px",o.scale(n,n),!0===r&&(s.style.imageRendering="-moz-crisp-edges",s.style.imageRendering="-webkit-crisp-edges",s.style.imageRendering="crisp-edges",s.style.imageRendering="pixelated",o.imageSmoothingEnabled=!1)}s.setAttribute("id",e),a(n,i),this.context=o,this.element=s,this.resize=a}new function(t){var e=t.assets,n=t.container,i=t.scenes,r=t.expose||!1,s=t.framerate||60,o=t.sharp||!1,a=t.speed||1,c={height:n.offsetHeight,width:n.offsetWidth},f=null,h=!1;this.preloading=!1,this.scenes=i,this.size=c,this.state={},this.version="0.36.0",this.load=function(t){f=t},this.restart=function(){h=!0},function(){var t=this,i=new u("2d","theatre",this.size.width,this.size.height,o);n.appendChild(i.element),this.container=n,this.context=i.context,this.element=i.element,this.assets={},this.delta={},this.delta.render=0,this.delta.update=0,this.loop=new function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=0,i=null,r=null;this.framerate=t,this.speed=e,this.render=function(t){var e=performance.now();null!==i&&t(e-i),requestAnimationFrame(this.render.bind(this,t)),i=e},this.update=function(t){var e=performance.now();if(null!==r)for(n+=e-r;n>=1e3/this.framerate/this.speed;)n-=1e3/this.framerate/this.speed,t(1e3/this.framerate);requestAnimationFrame(this.update.bind(this,t)),r=e}}(s,a),this.scene=this.scenes.loading,this.scene.setup.call(this),this.scene.start.call(this),this.loop.update(function(e){return t.delta.update=e,n.offsetWidth===t.size.width&&n.offsetHeight===t.size.height||(t.size.width=n.offsetWidth,t.size.height=n.offsetHeight,i.resize(t.size.width,t.size.height),t.scene.resize.call(t)),t.scene.update.call(t),!0===h?(t.scene.start.call(t),void(h=!1)):null!==f?(t.scene.destroy.call(t),t.scene=t.scenes[f],t.scene.setup.call(t),t.scene.start.call(t),void(f=null)):void 0}),this.loop.render(function(e){t.delta.render=e,t.scene.render.call(t)}),function(t,e){var n=[];t.forEach(function(t){var e=new Promise(function(e,n){if("dataset"===t.type&&(t.getter=function(){return t.source},e(t)),"image"===t.type){var i=new Image;i.src=t.source,i.onload=function(){t.getter=function(){return i},e(t)}}else if("sound"===t.type){var r=new Audio(t.source);r.oncanplaythrough=function(){t.getter=function(){return r.cloneNode()},e(t)}}});n.push(e)}),Promise.all(n).then(e)}(e,function(e){e.forEach(function(e){void 0===t.assets[e.type+"s"]&&(t.assets[e.type+"s"]={}),void 0===t.assets[e.type+"s"][e.scope]&&(t.assets[e.type+"s"][e.scope]={}),t.assets[e.type+"s"][e.scope][e.name]=e.getter}),t.preloading=!1}),this.preloading=!0}.call(this,t),!0===r&&(window.theatre=this)}({assets:o,container:document.body,expose:!0,scenes:i,sharp:!0})}]);
//# sourceMappingURL=index.js.map