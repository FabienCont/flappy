!function(e){function t(t){for(var n,s,i=t[0],r=t[1],a=0,u=[];a<i.length;a++)s=i[a],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&u.push(o[s][0]),o[s]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);for(c&&c(t);u.length;)u.shift()()}var n={},o={0:0};function s(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise((function(t,s){n=o[e]=[t,s]}));t.push(n[2]=i);var r,a=document.createElement("script");a.charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.src=function(e){return s.p+""+e+".index.js"}(e);var c=new Error;r=function(t){a.onerror=a.onload=null,clearTimeout(u);var n=o[e];if(0!==n){if(n){var s=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+s+": "+i+")",c.name="ChunkLoadError",c.type=s,c.request=i,n[1](c)}o[e]=void 0}};var u=setTimeout((function(){r({type:"timeout",target:a})}),12e4);a.onerror=a.onload=r,document.head.appendChild(a)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var i=window.webpackJsonp=window.webpackJsonp||[],r=i.push.bind(i);i.push=t,i=i.slice();for(var a=0;a<i.length;a++)t(i[a]);var c=r;s(s.s=29)}([function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var o=function(e){var t=this;e&&e.forEach((function(e){var n=i.call(t,e.name,e.scope);t.$world.system(e.components,n)}))},s=function(){try{var e=this.models.scenes[this.currentScene];return void 0!==e&&null!=e.renderers&&e.renderers()?e.renderers():[]}catch(e){console.error("no renderers found for this scene :"+this.currentScene)}},i=function(e,t){try{if("string"!=typeof e||""===e)throw"no system name defined";return this.models.systems[t][e]()[e]}catch(t){throw"no system found with name :"+e}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var o=function(e){var t=this;e.forEach((function(e){var n=i.call(t,e.name,e.scope);t.$world.system(e.components,n)}))},s=function(){try{var e=this.models.scenes[this.currentScene];return void 0!==e&&null!=e.systems&&e.systems()?e.systems():[]}catch(e){console.error("no systems found for this scene :"+this.currentScene)}},i=function(e,t){try{if("string"!=typeof e||""===e)throw"no system name defined";var n=this.models.systems[t][e]();if(n[e])return n[e];throw"system don't export good systemName"}catch(t){throw"no system found with name :"+e}}},function(e,t,n){"use strict";n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return h}));var o=n(3);function s(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=function(e){var t=this;try{var n="";return e.split(".").forEach((function(e,o){n=0==o?t[e]:n[e]})),n}catch(e){throw e}},c=function e(t,n){arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{for(var o={},s=Object.keys(t),c=0;c<s.length;c++){var u=s[c],f=t[u],d=n[u];if(null==d){if(null==f._default)throw"error missing parameter :"+u;var m=JSON.parse(JSON.stringify(f._default));"ref"===f._type&&(m=a.call(this,m)),o[u]=m}else if(f._type.startsWith("array")&&Array.isArray(d)){o[u]=[];var h=f._type.match("array<(.*)>")[1];if("array"===h)for(var l=0;l<d.length;l++){var p=e.call(this,{array:f["_"+h]},{array:d[l]});o[u].push(p.array)}else if("object"===h)for(l=0;l<d.length;l++)o[u].push(e.call(this,f["_"+h],d[l]));else{if("string"!==h&&"number"!==h&&"boolean"!==h)throw"missing/wrong subType"+h+"in array model for param :"+u;for(l=0;l<d.length;l++){if(h!=r(d[l]))throw"wrong subType"+h+"in array model for param :"+u;o[u].push(d[l])}}}else if("object"!==f._type||"object"!==r(d)||Array.isArray(d))if(f._type===r(d))o[u]=d;else{if("ref"!==f._type||"string"!=typeof d)throw"error wrong type parameters for "+u+": waiting "+f._type+" and get "+r(d);o[u]=a.call(this,d)}else{o[u]={};var y=Object.keys(f).filter((function(e){return!e.startsWith("_")}));for(l=0;l<y.length;l++){var g=y[l],v=d[g]?d[g]:{},x=e.call(this,i({},g,f[g]),i({},g,v));o[u][g]=x[g]}}}return o}catch(e){throw e}},u=function(e,t){return e.reduce((function(e,n){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){i(e,t,n[t])}))}return e}({},e,i({},n[t],n))}),{})},f=function(){try{var e=this.models.scenes[this.currentScene];if(e&&e.entities)return e.entities()}catch(e){console.error("no entities found for this scene :"+this.currentScene)}},d=function(e){var t=this;try{var n=[];return e.forEach((function(e){var i=l.call(t,e),a=u(e.components,"name"),c=function e(){for(var t=function(e){return e&&"object"===r(e)},n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return o.reduce((function(n,o){return Object.keys(o).forEach((function(i){var r=n[i],a=o[i];Array.isArray(r)&&Array.isArray(a)?n[i]=r.concat.apply(r,s(a)):t(r)&&t(a)?n[i]=e(r,a):n[i]=a})),n}),{})}(u(i.components,"name"),a),f=m.call(t,{name:i.name,components:Object.values(c)});f=new o.a(f.name,f.components),n.push(f)})),n}catch(e){console.error(e)}},m=function(e){var t=this;try{var n={name:e.name,components:[]};return e.components.forEach((function(e){var o=h.call(t,e);n.components.push(o)})),n}catch(e){throw e}},h=function(e){try{var t=p.call(this,e),n=e.params?e.params:{},o=c.call(this,t.params,n);return o.name=t.name,o}catch(e){throw e}},l=function(e){try{if("string"!=typeof e.name||""===e.name||"string"!=typeof e.scope||""===e.scope)throw"no entity name defined";return this.models.entities[e.scope][e.name]()}catch(t){throw"no entity found with name :"+e.name+" and scope :"+e.scope}},p=function(e){try{if("string"!=typeof e.name||""===e.name||"string"!=typeof e.scope||""===e.scope)throw"no component name defined";return this.models.components[e.scope][e.name]()}catch(t){throw"no component found with name :"+e.name+" and scope :"+e.scope}},y=function(){var e=f.call(this);return d.call(this,e)}},function(e,t,n){"use strict";function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,s=!1,i=void 0;try{for(var r,a=e[Symbol.iterator]();!(o=(r=a.next()).done)&&(n.push(r.value),!t||n.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t){this.components={},this.name=e,this.add=function(e){var t=this;!1===Array.isArray(e)&&(e=[e]),e.forEach((function(e){t.components[e.name]=e}))},this.get=function(e){return this.components[e]},this.has=function(e){!1===Array.isArray(e)&&(e=[e]);for(var t=0,n=e.length;t<n;t+=1){var o=e[t],s=o.replace("not:",""),i=o!==s;if(this.components.hasOwnProperty(s)===i)return!1}return!0},this.remove=function(e){!1===Array.isArray(e)&&(e=[e]);for(var t=0,n=e.length;t<n;t+=1){var o=e[t];!0===this.components.hasOwnProperty(o)&&delete this.components[o]}},this.add(t)}function i(e){this.entities={},this.add=function(e){var t=this;!1===Array.isArray(e)&&(e=[e]),e.forEach((function(e){t.entities[e.name]=e}))},this.get=function(e){return this.entities[e]},this.remove=function(e){!1===Array.isArray(e)&&(e=[e]);for(var t=0,n=e.length;t<n;t+=1){var o=e[t],s=o.name||o;!0===this.entities.hasOwnProperty(s)&&delete this.entities[s]}},this.system=function(t,n){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.entities,i={};Object.entries(s).forEach((function(e){var n=o(e,2),s=n[0],r=n[1];!0===r.has(t)&&(i[s]=r)})),n.call(e,i)}}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}))},function(e){e.exports=JSON.parse('{"name":"top","components":[{"name":"camera","scope":"common"},{"name":"decor","scope":"demo"},{"name":"position","scope":"common","params":{"x":-96,"y":-96,"z":100}},{"name":"hitbox","scope":"common","params":{"width":64,"height":16}},{"name":"origin","scope":"common"},{"name":"images","scope":"common","params":{"parts":[{"source":{"scope":"demo","file":"foreground-16x16@1x"},"frames":[[1,0,16,16]],"frame":0,"destination":[0,0,0,16,16]},{"source":{"scope":"demo","file":"foreground-16x16@1x"},"frames":[[2,0,16,16]],"frame":0,"destination":[16,0,0,16,16]},{"source":{"scope":"demo","file":"foreground-16x16@1x"},"frames":[[0,0,16,16]],"frame":0,"destination":[32,0,0,16,16]},{"source":{"scope":"demo","file":"foreground-16x16@1x"},"frames":[[0,0,16,16]],"frame":0,"destination":[48,0,0,16,16]}]}}]}')},function(e){e.exports=JSON.parse('{"name":"bottom","components":[{"name":"camera","scope":"common"},{"name":"decor","scope":"demo"},{"name":"position","scope":"common","params":{"x":-96,"y":96,"z":100}},{"name":"hitbox","scope":"common","params":{"width":64,"height":16}},{"name":"origin","scope":"common"},{"name":"images","scope":"common","params":{"parts":[{"source":{"scope":"demo","file":"foreground-16x16@1x"},"frames":[[1,2,16,16]],"frame":0,"destination":[0,0,0,16,16]},{"source":{"scope":"demo","file":"foreground-16x16@1x"},"frames":[[2,2,16,16]],"frame":0,"destination":[16,0,0,16,16]},{"source":{"scope":"demo","file":"foreground-16x16@1x"},"frames":[[0,2,16,16]],"frame":0,"destination":[32,0,0,16,16]},{"source":{"scope":"demo","file":"foreground-16x16@1x"},"frames":[[0,2,16,16]],"frame":0,"destination":[48,0,0,16,16]}]}}]}')},function(e){e.exports=JSON.parse('{"name":"water","components":[{"name":"camera","scope":"common"},{"name":"decor","scope":"demo"},{"name":"position","scope":"common","params":{"x":-96,"y":96,"z":100}},{"name":"origin","scope":"common"},{"name":"forces","scope":"common","params":{"parts":[{"x":1,"y":0,"duration":200,"easing":{"type":"snippets","scope":"demo","name":"ease-linear"},"elapsed":0,"ending":{"type":"snippets","scope":"demo","name":"forces-water-left"},"handling":{"type":"snippets","scope":"demo","name":"forces-handling"}}]}},{"name":"images","scope":"common","params":{"parts":[{"source":{"scope":"demo","file":"waves-16x16@1x"},"frames":[[0,0,16,16]],"frame":0,"destination":[0,8,111,17,17]},{"source":{"scope":"demo","file":"waves-16x16@1x"},"frames":[[0,0,16,16]],"frame":0,"destination":[16,8,111,17,17]},{"source":{"scope":"demo","file":"waves-16x16@1x"},"frames":[[0,0,16,16]],"frame":0,"destination":[32,8,111,17,17]},{"source":{"scope":"demo","file":"waves-16x16@1x"},"frames":[[0,0,16,16]],"frame":0,"destination":[48,8,111,17,17]}]}}]}')},function(e){e.exports=JSON.parse('{"name":"background","components":[{"name":"camera","scope":"common"},{"name":"decor","scope":"demo"},{"name":"position","scope":"common","params":{"x":-96,"y":0}},{"name":"origin","scope":"common"},{"name":"images","scope":"common","params":{"parts":[{"source":{"scope":"demo","file":"background-16x16@1x"},"frames":[[0,0,16,16]],"frame":0,"destination":[0,-96,0,100,200]},{"source":{"scope":"demo","file":"background-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,112,110,64,64]}]}}]}')},function(e){e.exports=JSON.parse('{"name":"pipeTop","components":[{"name":"camera","scope":"common"},{"name":"position","scope":"common","params":{"x":-48,"y":-96,"z":99}},{"name":"decor","scope":"demo"},{"name":"hitbox","scope":"common","params":{"height":48,"width":16}},{"name":"origin","scope":"common"},{"name":"images","scope":"common","params":{"parts":[{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,-64,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,-48,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,-32,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,-16,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,0,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,16,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,32,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,48,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,2,16,16]],"frame":0,"destination":[0,64,0,16,16]}]}}]}')},function(e){e.exports=JSON.parse('{"name":"pipeBottom","components":[{"name":"camera","scope":"common"},{"name":"decor","scope":"demo"},{"name":"position","scope":"common","params":{"x":-48,"y":32,"z":99}},{"name":"hitbox","scope":"common","params":{"height":48,"width":16}},{"name":"origin","scope":"common"},{"name":"images","scope":"common","params":{"parts":[{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,0,16,16]],"frame":0,"destination":[0,0,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,16,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,32,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,48,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,64,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,80,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,96,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,112,0,16,16]},{"source":{"scope":"demo","file":"pipe-16x16@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[0,80,0,16,16]},{"source":{"scope":"demo","file":"pipe-shadow-16x8@1x"},"frames":[[0,0,16,16]],"frame":0,"destination":[64,80,110,16,16]},{"source":{"scope":"demo","file":"pipe-shadow-16x8@1x"},"frames":[[0,1,16,16]],"frame":0,"destination":[64,94,110,16,16]}]}}]}')},function(e,t,n){"use strict";function o(e){return function(t){return Math.pow(t,e)}}function s(e){return function(t){return 1-o(e)(1-t)}}function i(e){return function(t){return t*e}}function r(e){return o(4)(e)}function a(e){return s(2)(e)}function c(e){return s(4)(e)}function u(e){return function(t){return e(1-t)}}n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return u}))},function(e,t,n){"use strict";n.r(t),n.d(t,"generateDecor",(function(){return d}));var o=n(2),s=n(4),i=n(5),r=n(6),a=n(7),c=n(8),u=n(9);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,s=!1,i=void 0;try{for(var r,a=e[Symbol.iterator]();!(o=(r=a.next()).done)&&(n.push(r.value),!t||n.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(e){var t=this,n=0,d=this.$camera.screen.x()-this.$camera.screen.width()/(2*this.$camera.screen.scale()),m=this.$camera.position.x()+(this.$camera.screen.x()+this.$camera.screen.width()/(2*this.$camera.screen.scale())),h=this.$camera.position.x()+d,l=h;for(Object.entries(e).filter((function(e){var n=f(e,2),o=(n[0],n[1]),s=o.get("position").x+90<h;return s&&t.$world.remove(o),!s})),Object.entries(e).forEach((function(e){var t=f(e,2),o=t[0],s=t[1];if(o.startsWith("bottom")){0;var i=o.split("bottom")[1];(i=i)>n&&(n=i,l=s.get("position").x+s.get("hitbox").width)}})),s.scope="demo",i.scope="demo",r.scope="demo",a.scope="demo",c.scope="demo",u.scope="demo";m>l;){n++,o.b.call(this,[s,i,a,r,c,u]).map((function(e){e.name=e.name+n,e.get("position").x=l,t.$world.add(e)})),l+=64}}},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){"use strict";function o(){this.$controllers.inputs.length=0}n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";function o(){}n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";function o(){console.log("destroy demo scene"),console.log("-------"),this.$controllers.destroy(),delete this.$camera,delete this.$controllers,delete this.$origins,delete this.$world.entities,delete this.$world,delete this.$systems,delete this.$renderers}n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(0);function s(){this.context.fillStyle="#cbdbfc",this.context.fillRect(0,0,this.size.width,this.size.height),o.b.call(this,this.$renderers),this.$camera.render()}},function(e,t,n){"use strict";function o(){console.log("resize demo scene")}n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(2);function s(){console.log("start demo scene");var e=o.c.call(this);this.$world.add(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(1);function s(){var e=this;o.b.call(this,this.$systems),this.$camera.position.x=function(){return e.$world.entities.character.get("position").x+50},this.$camera.update(this.delta.update)}},function(e,t,n){"use strict";function o(){}n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";function o(){}n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";function o(){console.log("destroy loading scene"),console.log("-------"),delete this.state.redirect,delete this.$systems,delete this.$renderers}n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(0);function s(){o.b.call(this,this.$renderers),this.context.fillStyle="#181a1f",this.context.fillRect(0,0,this.size.width,this.size.height),this.context.font="16px Courier New",this.context.textAlign="start",this.context.textBaseline="top",this.context.fillStyle="#6b717d",this.context.fillText("/ Theatre",8,8),this.context.fillStyle="#d7dae0",this.context.fillText("$ preloading assets...",8,32),!1===this.preloading&&(this.context.fillText("$ preloading completed",8,56),this.context.fillText("$ loading demo scene...",8,80))}},function(e,t,n){"use strict";function o(){console.log("resize loading scene")}n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(0),s=n(1);function i(){console.log("setup loading scene"),this.$renderers=o.a.call(this),this.$systems=s.a.call(this)}},function(e,t,n){"use strict";function o(){console.log("start loading scene"),this.state.redirect=!1}n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";function o(){var e=this;!1===this.preloading&&!1===this.state.redirect&&(setTimeout((function(){e.load("demo")}),100),this.state.redirect=!0)}n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var o=n(10);function s(e,t,n){var s=[];this.name=t,this.position={x:function(){return 0},y:function(){return 0}},this.screen={x:n.x,y:n.y,width:n.width,height:n.height,scale:n.scale},this.shaking={current:!1,duration:0,easing:null,elapsed:0,force:{x:0,y:0},shift:{x:0,y:0}},this.add=function(e){for(var t=0,n=s.length-1;n>=0;n-=1){var o=s[n];if(e.destination.z>o.destination.z||e.destination.z===o.destination.z&&e.destination.y>=o.destination.y){t=n+1;break}}s.splice(t,0,e)},this.idle=function(){this.shaking={current:!1,duration:0,easing:null,elapsed:0,force:{x:0,y:0},shift:{x:0,y:0}}},this.look=function(e,t){this.position.x=e,this.position.y=t},this.render=function(){var t=this;s.forEach((function(n){var o=n.destination,s=n.frame,i=n.opacity,r=n.source,a=t.visible(o.x*t.screen.scale(),o.y*t.screen.scale(),o.width*t.screen.scale(),o.height*t.screen.scale());if(i>0&&!0===a){var c=e.globalAlpha;e.globalAlpha=i;var u={destination:{x:t.screen.x()+o.x*t.screen.scale()-(t.position.x()*t.screen.scale()-t.screen.width()/2+t.shaking.shift.x*t.screen.scale()),y:t.screen.y()+o.y*t.screen.scale()-(t.position.y()*t.screen.scale()-t.screen.height()/2+t.shaking.shift.y*t.screen.scale()),width:o.width*t.screen.scale(),height:o.height*t.screen.scale()}},f={top:Math.min(0,u.destination.y-t.screen.y()),right:Math.max(0,u.destination.x+u.destination.width-(t.screen.x()+t.screen.width())),bottom:Math.max(0,u.destination.y+u.destination.height-(t.screen.y()+t.screen.height())),left:Math.min(0,u.destination.x-t.screen.x())};e.drawImage(r,s.x-f.left*(s.width/u.destination.width),s.y-f.top*(s.height/u.destination.height),s.width-f.right*(s.width/u.destination.width)-Math.abs(f.left*(s.height/u.destination.height)),s.height-f.bottom*(s.height/u.destination.height)-Math.abs(f.top*(s.height/u.destination.height)),u.destination.x-f.left,u.destination.y-f.top,u.destination.width-f.right-Math.abs(f.left),u.destination.height-f.bottom-Math.abs(f.top)),e.globalAlpha=c}})),s=[]},this.shake=function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.f(o.b(2));this.idle(),this.shaking.force={x:e,y:t},this.shaking.current=!0,this.shaking.duration=n,this.shaking.easing=s},this.update=function(e){if(!1!==this.shaking.current)if(this.shaking.elapsed+e>=this.shaking.duration)this.idle();else{this.shaking.elapsed+=e;var t=this.shaking.easing(this.shaking.elapsed/this.shaking.duration),n=2*Math.random()*Math.PI;this.shaking.shift.x=Math.round(Math.cos(n)*this.shaking.force.x*t),this.shaking.shift.y=Math.round(Math.sin(n)*this.shaking.force.y*t)}},this.visible=function(e,t,n,o){var s=this.position.x()*this.screen.scale()-this.screen.width()/2+this.shaking.shift.x*this.screen.scale(),i=this.position.y()*this.screen.scale()-this.screen.height()/2+this.shaking.shift.y*this.screen.scale(),r=this.screen.width(),a=this.screen.height();return!(e+n<=s||e>=s+r||t+o<=i||t>=i+a)}}var i=[];function r(e,t,n){var o={};function s(){for(var e in o)o.hasOwnProperty(e)&&!0===o[e]&&(o[e]=!1,n.push({type:"KEYBOARD",action:e,state:"UP"}))}function r(e){var s="KEY_"+i[e.keyCode];-1!==t.indexOf(s)&&!1===o[s]&&(e.preventDefault(),o[s]=!0,n.push({type:"KEYBOARD",action:s,state:"DOWN"}))}function a(e){var s="KEY_"+i[e.keyCode];-1!==t.indexOf(s)&&!0===o[s]&&(e.preventDefault(),o[s]=!1,n.push({type:"KEYBOARD",action:s,state:"UP"}))}function c(){e.addEventListener("blur",s),e.addEventListener("keydown",r),e.addEventListener("keyup",a)}t.forEach((function(e){o[e]=!1})),c.call(this),this.destroy=function(){e.removeEventListener("blur",s),e.removeEventListener("keydown",r),e.removeEventListener("keyup",a)},this.setup=c}function a(e,t,n){function o(e){-1!==t.indexOf("CLICK_RIGHT")&&e.preventDefault()}function s(e){var o=e.button,s=["LEFT","MIDDLE","RIGHT"];if(void 0!==s[o]){var i="CLICK_"+s[o];if(-1!==t.indexOf(i)){e.preventDefault();var r=e.target.getBoundingClientRect(),a=e.clientX-r.left,c=e.clientY-r.top;n.push({type:"MOUSE",action:i,state:"DOWN",x:a,y:c})}}}function i(e){if(-1!==t.indexOf("MOVE")){e.preventDefault();var o=e.target.getBoundingClientRect(),s=e.clientX-o.left,i=e.clientY-o.top;n.push({type:"MOUSE",action:"MOVE",state:"ENTER",x:s,y:i})}}function r(e){if(-1!==t.indexOf("MOVE")){e.preventDefault();var o=e.target.getBoundingClientRect(),s=e.clientX-o.left,i=e.clientY-o.top;n.push({type:"MOUSE",action:"MOVE",state:"LEAVE",x:s,y:i})}}function a(e){if(-1!==t.indexOf("MOVE")){e.preventDefault();var o=e.target.getBoundingClientRect(),s=e.clientX-o.left,i=e.clientY-o.top;n.push({type:"MOUSE",action:"MOVE",x:s,y:i})}}function c(e){var o=e.button,s=["LEFT","MIDDLE","RIGHT"];if(void 0!==s[o]){var i="CLICK_"+s[o];if(-1!==t.indexOf(i)){e.preventDefault();var r=e.target.getBoundingClientRect(),a=e.clientX-r.left,c=e.clientY-r.top;n.push({type:"MOUSE",action:i,state:"UP",x:a,y:c})}}}function u(){e.addEventListener("contextmenu",o),e.addEventListener("mousedown",s),e.addEventListener("mouseenter",i),e.addEventListener("mouseleave",r),e.addEventListener("mousemove",a),e.addEventListener("mouseup",c),e.addEventListener("wheel",f)}function f(e){if(-1!==t.indexOf("SCROLL")){e.preventDefault();var o,s=e.target.getBoundingClientRect(),i=e.clientX-s.left,r=e.clientY-s.top;Math.abs(e.deltaY)>=Math.abs(e.deltaX)?(o="DOWN",e.deltaY<0&&(o="UP")):(o="RIGHT",e.deltaX<0&&(o="LEFT")),n.push({type:"MOUSE",action:"SCROLL",state:o,x:i,y:r})}}u.call(this),this.destroy=function(){e.removeEventListener("contextmenu",o),e.removeEventListener("mousedown",s),e.removeEventListener("mouseenter",i),e.removeEventListener("mouseleave",r),e.removeEventListener("mousemove",a),e.removeEventListener("mouseup",c),e.removeEventListener("wheel",f)},this.setup=u}function c(e,t){var n=[],o=[];(function(){n.push(new r(e,t,o)),n.push(new a(e,t,o))}).call(this),this.destroy=function(){n.forEach((function(e){e.destroy()}))},this.inputs=o}i[9]="TAB",i[13]="ENTER",i[16]="SHIFT",i[17]="CTRL",i[18]="ALT",i[27]="ESC",i[32]="SPACE",i[37]="LEFT",i[38]="UP",i[39]="RIGHT",i[40]="DOWN",i[48]="ZERO",i[49]="ONE",i[50]="TWO",i[51]="THREE",i[52]="FOUR",i[53]="FIVE",i[54]="SIX",i[55]="SEVEN",i[56]="EIGHT",i[57]="NINE",i[65]="A",i[66]="B",i[67]="C",i[68]="D",i[69]="E",i[70]="F",i[71]="G",i[72]="H",i[73]="I",i[74]="J",i[75]="K",i[76]="L",i[77]="M",i[78]="N",i[79]="O",i[80]="P",i[81]="Q",i[82]="R",i[83]="S",i[84]="T",i[85]="U",i[86]="V",i[87]="W",i[88]="X",i[89]="Y",i[90]="Z";var u=n(3),f=n(0),d=n(1),m=n(11);function h(){var e=this;console.log("setup demo scene"),this.$origins={default:{x:function(){return 0},y:function(){return-20},z:function(){return 0},scale:function(){return 1}}},this.$controllers=new c(this.element,this.models.scenes[this.currentScene].inputs()),this.$world=new u.b(this),this.$camera=new s(this.context,"default",{x:function(){return 0},y:function(){return 0},width:function(){return e.size.width},height:function(){return e.size.height},scale:function(){return 3}}),this.$renderers=f.a.call(this),this.$systems=d.a.call(this),m.generateDecor.call(this,{})}},function(e,t,n){e.exports=n(35)},function(e,t,n){var o={"./datasets/common/inputs.json":[36,40],"./images/common/placeholder-8x1.png":[37,20],"./images/demo/all-flappy-bird-16x16@1x.png":[38,21],"./images/demo/background-16x16@1x.png":[39,22],"./images/demo/best-48x16@1x.png":[40,23],"./images/demo/character-32x32.png":[41,24],"./images/demo/clouds-160x16@1x.png":[42,25],"./images/demo/flappy-bird-16x16@1x.png":[43,26],"./images/demo/flappy-bird-shadow-16x8@1x.png":[44,27],"./images/demo/foreground-16x16@1x.png":[45,28],"./images/demo/game-over-64x64@1x.png":[46,29],"./images/demo/numbers-8x16@1x.png":[47,30],"./images/demo/numbers-blue-8x16@1x.png":[48,31],"./images/demo/pipe-16x16@1x.png":[49,32],"./images/demo/pipe-shadow-16x8@1x.png":[50,33],"./images/demo/touch-screen-64x32@1x.png":[51,34],"./images/demo/waves-16x16@1x.png":[52,35],"./sounds/demo/explode.mp3":[53,36],"./sounds/demo/jump.mp3":[54,37],"./spritesheets/common/character-32x32.png":[55,38],"./spritesheets/common/spritesheet.png":[56,39]};function s(e){if(!n.o(o,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],s=t[0];return n.e(t[1]).then((function(){return n(s)}))}s.keys=function(){return Object.keys(o)},s.id=30,e.exports=s},function(e,t,n){var o={"./components/common/camera.json":[57,41],"./components/common/commands.json":[58,42],"./components/common/fade.json":[59,43],"./components/common/forces.json":[60,44],"./components/common/hitbox.json":[61,45],"./components/common/images.json":[62,46],"./components/common/inputs.json":[63,47],"./components/common/origin.json":[64,48],"./components/common/position.json":[65,49],"./components/demo/decor.json":[66,50],"./components/demo/player.json":[67,51],"./entities/demo/background.json":[7],"./entities/demo/bottom.json":[5],"./entities/demo/character.json":[68,52],"./entities/demo/pipeBottom.json":[9],"./entities/demo/pipeTop.json":[8],"./entities/demo/top.json":[4],"./entities/demo/water.json":[6],"./scenes/demo/entities.json":[69,53],"./scenes/demo/inputs.json":[70,54],"./scenes/demo/renderers.json":[71,55],"./scenes/demo/systems.json":[72,56],"./snippets/demo/ease-in.js":[73,1],"./snippets/demo/ease-linear.js":[74,2],"./snippets/demo/ease-out.js":[75,3],"./snippets/demo/fade-ending.js":[76,4],"./snippets/demo/forces-down.js":[77,5],"./snippets/demo/forces-ending.js":[78,6],"./snippets/demo/forces-handling.js":[79,7],"./snippets/demo/forces-water-left.js":[80,8],"./snippets/demo/forces-water-right.js":[81,9],"./snippets/demo/handle-hitbox.js":[82,10],"./snippets/demo/timeout-ending.js":[83,11],"./systems/common/fade.js":[84,12],"./systems/common/forces.js":[85,13],"./systems/common/hitbox.js":[91,14],"./systems/common/images.js":[86,15],"./systems/common/inputs.js":[87,16],"./systems/common/spritesheets.js":[88,17],"./systems/demo/commands.js":[89,18],"./systems/demo/generateDecor.js":[11],"./systems/demo/move.js":[90,19]};function s(e){if(!n.o(o,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],s=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(s)}))}s.keys=function(){return Object.keys(o)},s.id=31,e.exports=s},function(e,t,n){var o={"./demo/index.js":33,"./loading/index.js":34};function s(e){var t=i(e);return n(t)}function i(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}s.keys=function(){return Object.keys(o)},s.resolve=i,e.exports=s,s.id=32},function(e,t,n){"use strict";n.r(t),function(e){var o=n(13);n.d(t,"after",(function(){return o.a}));var s=n(14);n.d(t,"before",(function(){return s.a}));var i=n(15);n.d(t,"destroy",(function(){return i.a}));var r=n(16);n.d(t,"render",(function(){return r.a}));var a=n(17);n.d(t,"resize",(function(){return a.a}));var c=n(28);n.d(t,"setup",(function(){return c.a}));var u=n(18);n.d(t,"start",(function(){return u.a}));var f=n(19);n.d(t,"update",(function(){return f.a})),void 0!==e.hot&&e.hot.accept(["./after.js","./before.js","./destroy.js","./render.js","./resize.js","./setup.js","./start.js","./update.js"])}.call(this,n(12)(e))},function(e,t,n){"use strict";n.r(t),function(e){var o=n(20);n.d(t,"after",(function(){return o.a}));var s=n(21);n.d(t,"before",(function(){return s.a}));var i=n(22);n.d(t,"destroy",(function(){return i.a}));var r=n(23);n.d(t,"render",(function(){return r.a}));var a=n(24);n.d(t,"resize",(function(){return a.a}));var c=n(25);n.d(t,"setup",(function(){return c.a}));var u=n(26);n.d(t,"start",(function(){return u.a}));var f=n(27);n.d(t,"update",(function(){return f.a})),void 0!==e.hot&&e.hot.accept(["./after.js","./before.js","./destroy.js","./render.js","./resize.js","./setup.js","./start.js","./update.js"])}.call(this,n(12)(e))},function(e,t,n){"use strict";function o(e,t,n,o){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=document.createElement("canvas"),r=i.getContext(e);function a(){i.setAttribute("tabindex",0),i.focus()}function c(e,t){var n=window.devicePixelRatio||1;!0===s&&(n=Math.floor(n)),i.setAttribute("height",n*t),i.setAttribute("width",n*e),i.style.height="100%",i.style.width="100%",r.scale(n,n),!0===s&&u()}function u(){i.style.imageRendering="-moz-crisp-edges",i.style.imageRendering="-webkit-crisp-edges",i.style.imageRendering="crisp-edges",i.style.imageRendering="pixelated",r.imageSmoothingEnabled=!1}i.setAttribute("id",t),i.addEventListener("mousedown",a),c(n,o),this.context=r,this.element=i,this.focus=a,this.resize=c}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=0,s=null,i=!1;function r(){var t=performance.now();if(null!==s&&!1===i)for(o+=t-s;o>=1e3/this.framerate/this.speed&&!1===i;)o-=1e3/this.framerate/this.speed,e(1e3/this.framerate);requestAnimationFrame(this.update.bind(this)),s=t}function a(){i=!0}function c(){i=!1}function u(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;requestAnimationFrame((function(){for(;n--;)e(1e3/t.framerate)}))}this.framerate=t,this.speed=n,this.pause=a,this.play=c,this.tick=u,this.update=r}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,s=!1,i=void 0;try{for(var r,a=e[Symbol.iterator]();!(o=(r=a.next()).done)&&(n.push(r.value),!t||n.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.r(t);var r=function(){var e=this;return new Promise((function(t,o){var s=n(30),r=[];e.assetsLoaded=[],s.keys().forEach((function(t){var n=new Promise((function(n,o){s(t).then((function(o){var s=e.assetsLoaded.find((function(e){return e.key==t}));if(s&&s.source!=o||void 0===s){if(void 0!==s&&s.source!=o){var r=e.assetsLoaded.indexOf(s);r>-1&&e.assetsLoaded.splice(r,1)}(function(e,t){return new Promise((function(n,o){console.log("load assets or reload");var s=i(e.match(/(?!\.\/|\/)(.+?)(?=(?:\.[^\.\/]+$)|\/)/g),3),r=s[0],a=s[1],c=s[2],u={key:e,name:c,scope:a,source:t,type:r.substring(0,r.length-1)};if("dataset"===u.type&&(u.getter=function(){return u.source},n(u)),"image"===u.type||"spritesheet"===u.type){var f=new Image;f.src=u.source,f.onload=function(){u.getter=function(){return f},n(u)}}else if("sound"===u.type){var d=new Audio(u.source);d.oncanplaythrough=function(){u.getter=function(){return d.cloneNode()},n(u)}}}))})(t,o).then((function(t){e.assetsLoaded.push(t),void 0===e.assets[t.type+"s"]&&(e.assets[t.type+"s"]={}),void 0===e.assets[t.type+"s"][t.scope]&&(e.assets[t.type+"s"][t.scope]={}),e.assets[t.type+"s"][t.scope][t.name]=t.getter}))}n(o)}))}));r.push(n)})),Promise.all(r).then((function(e){t()}))}))};function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,s=!1,i=void 0;try{for(var r,a=e[Symbol.iterator]();!(o=(r=a.next()).done)&&(n.push(r.value),!t||n.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var c=function(){var e=this;return new Promise((function(t,o){var s=n(31),i=[];e.modelsLoaded=[],s.keys().forEach((function(t){var n=new Promise((function(n,o){s(t).then((function(o){var s=e.modelsLoaded.find((function(e){return e.key==t}));if(s&&s.source!=o||void 0===s){if(void 0!==s&&s.source!=o){var i=e.modelsLoaded.indexOf(s);i>-1&&e.modelsLoaded.splice(i,1)}u.call(e,t,o).then((function(t){e.modelsLoaded.push(t),void 0===e.models[t.type+"s"]&&(e.models[t.type+"s"]={}),void 0===e.models[t.type+"s"][t.scope]&&(e.models[t.type+"s"][t.scope]={}),e.models[t.type+"s"][t.scope][t.name]=t.getter}))}n(o)}))}));i.push(n)})),Promise.all(i).then((function(e){t()}))}))};function u(e,t){var n=this;return new Promise((function(o,s){console.log("load models or reload");var i=a(e.match(/(?!\.\/|\/)(.+?)(?=(?:\.[^\.\/]+$)|\/)/g),3),r=i[0],c=i[1],u=i[2],f={key:e,name:u,scope:c,source:t,type:r.substring(0,r.length-1)};"snippets"===r?(f.getter=f.source.default.bind(n),o(f)):f.getter=function(){return f.source},o(f)}))}var f=function(){var e=this,t=n(32);t.keys().forEach((function(n){var o=n.match(/^\.\/([^\/]+)\/index\.js$/)[1];e.scenes[o]=t(n)}))};new function(e){var t=e.container,n=e.expose||!1,i=e.framerate||60,a=e.sharp||!1,u=e.speed||1,d={height:t.offsetHeight,width:t.offsetWidth},m=null,h=null,l=!1,p=0;function y(e){this.delta=e,t.offsetWidth===this.size.width&&t.offsetHeight===this.size.height||g.call(this),!0===this.playing&&this.tick(),this.scene.before.call(this),p>0&&v.call(this),this.scene.render.call(this),this.scene.after.call(this)}function g(){this.size.width=t.offsetWidth,this.size.height=t.offsetHeight,m.resize(this.size.width,this.size.height),this.scene.resize.call(this)}function v(){for(;p>0;)this.scene.update.call(this),p-=1,!0!==l?null===h||(this.scene.destroy.call(this),this.scene=this.scenes[h],this.currentScene=h,this.scene.setup.call(this),this.scene.start.call(this),h=null):(this.scene.start.call(this),l=!1)}this.playing=!0,this.preloading=!0,this.currentScene,this.$={},this.scenes={},this.size=d,this.snippets={},this.state={},this.version="0.39.0",this.load=function(e){h=e},this.pause=function(){this.playing=!1},this.play=function(){this.playing=!0},this.restart=function(){l=!0},this.tick=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;p+=e},function(){var e=this;m=new o("2d","theatre",this.size.width,this.size.height,a),t.appendChild(m.element),m.focus(),this.container=t,this.context=m.context,this.element=m.element,this.models={},this.assets={},this.delta=0,this.loop=new s(y.bind(this),i,u);var n=r.call(this),d=c.call(this);f.call(this),Promise.all([n,d]).then((function(t){e.preloading=!1})),this.scene=this.scenes.loading,this.scene.setup.call(this),this.scene.start.call(this),this.loop.update()}.call(this,e),!0===n&&(window.theatre=this)}({container:document.body.querySelector(".theatre-container"),expose:!0,sharp:!0})}]);
//# sourceMappingURL=index.js.map