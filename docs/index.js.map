{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./sources/theatre/core/loadRenderers.js","webpack:///./sources/theatre/core/loadSystems.js","webpack:///./sources/theatre/core/loadEntities.js","webpack:///./sources/theatre/modules/world.js","webpack:///./sources/theatre/modules/ease.js","webpack:///./sources/game/models/systems/demo/generateDecor.js","webpack:///./sources/theatre/modules/shape.js","webpack:///(webpack)/buildin/harmony-module.js","webpack:///./sources/game/scenes/demo/after.js","webpack:///./sources/game/scenes/demo/before.js","webpack:///./sources/game/scenes/demo/destroy.js","webpack:///./sources/game/scenes/demo/render.js","webpack:///./sources/game/models/systems/common/showHitbox.js","webpack:///./sources/game/scenes/demo/resize.js","webpack:///./sources/game/scenes/demo/setup.js","webpack:///./sources/game/scenes/demo/update.js","webpack:///./sources/game/scenes/loading/after.js","webpack:///./sources/game/scenes/loading/before.js","webpack:///./sources/game/scenes/loading/destroy.js","webpack:///./sources/game/scenes/loading/render.js","webpack:///./sources/game/scenes/loading/resize.js","webpack:///./sources/game/scenes/loading/setup.js","webpack:///./sources/game/scenes/loading/start.js","webpack:///./sources/game/scenes/loading/update.js","webpack:///./sources/theatre/modules/camera.js","webpack:///./sources/theatre/modules/keynames.js","webpack:///./sources/theatre/modules/keyboard.js","webpack:///./sources/theatre/modules/mouse.js","webpack:///./sources/theatre/modules/controllers.js","webpack:///./sources/game/scenes/demo/start.js","webpack:///./sources/game/assets lazy ^.\\/.+\\.[a-zA-Z0-9]+$","webpack:///./sources/game/models lazy ^.\\/.+\\.[a-zA-Z0-9]+$","webpack:///./sources/game/scenes sync ^\\.\\/[^\\/]+\\/index\\.js$","webpack:///./sources/game/scenes/demo/index.js","webpack:///./sources/game/scenes/loading/index.js","webpack:///./sources/theatre/core/canvas.js","webpack:///./sources/theatre/core/loop.js","webpack:///./sources/theatre/core/preloadAssets.js","webpack:///./sources/theatre/core/preloadModels.js","webpack:///./sources/theatre/core/preloadScenes.js","webpack:///./sources/index.js","webpack:///./sources/theatre/core/theatre.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","installedModules","0","__webpack_require__","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","p","jsonpScriptSrc","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","name","request","undefined","setTimeout","head","appendChild","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","s","loadRenderers","sceneRenderers","forEach","renderer","rendererSystem","getSystem","scope","$world","system","components","getRenderers","sceneModel","this","models","scenes","currentScene","renderers","systemName","systemScope","systems","loadSystems","sceneSystems","updateSystem","getSystems","systemModule","cloneProto","Array","isArray","a","fn","keys","a2","k","cur","cloneArray","o2","loadRef","ref","split","path","createNewParamsFromModel","paramsModel","params","newParams","keysParamsModel","keyModel","modelNewParam","valueParam","_default","defaultValue","JSON","parse","stringify","_type","startsWith","arraySubType","match","arrayObject","array","modelNewParamKeys","filter","modelNewParamKey","valueParamOfKey","newParamObject","convertArrayToObject","reduce","obj","item","getEntitiesScene","entities","setCachedEntity","entityRef","entityGenerated","cachedEntities","generateEntities","sceneEntities","newEntity","entityDef","getEntityDefinition","componentsOverride","newEntityComponents","mergeDeep","isObject","objects","prev","pVal","oVal","concat","generateEntityModel","values","Entity","entityModelOverride","loadedEntity","component","newComponent","createComponentFromModel","componentRef","componentModel","getComponentModel","loadEntities","add","has","iterator","search","replace","exclude","remove","World","context","entity","handler","chosen","entries","easeIn","power","x","easeOut","linear","factor","easeInQuad","easeOutQuad","reverse","generateDecor","birdPosition","character","maxPosBeyondBird","minPosition","entitiesName","$infos","started","decorEntities","demo","width","entityName","isOut","entityId","maxPosition","maxId","parseInt","maxPosPipe","entityInfo","model","map","Point","y","Rectangle","height","originalModule","webpackPolyfill","children","after","$controllers","inputs","before","destroy","log","$camera","$origins","$systems","$renderers","render","fillStyle","fillRect","size","$cameraInfo","showHitbox","cameraComponent","hitboxComponent","originComponent","positionComponent","camera","hitbox","reference","screen","scale","position","shaking","save","lineWidth","strokeStyle","strokeRect","restore","resize","setup","update","delta","state","redirect","font","textAlign","textBaseline","fillText","preloading","start","load","Camera","images","image","current","destination","z","splice","idle","look","frame","opacity","source","visible","alpha","globalAlpha","canvas","offset","Math","min","max","drawImage","left","top","right","abs","bottom","shake","duration","easing","Ease","force","elapsed","amplitude","angle","random","PI","round","cos","sin","keynames","Keyboard","container","actions","states","blur","keydown","action","keyCode","indexOf","preventDefault","keyup","addEventListener","removeEventListener","Mouse","contextmenu","mousedown","button","buttons","rectangle","getBoundingClientRect","clientX","clientY","mouseenter","mouseleave","mousemove","mouseup","wheel","deltaY","deltaX","Controllers","controllers","controller","element","webpackAsyncContext","req","then","code","ids","id","webpackContext","webpackContextResolve","hot","accept","Canvas","identifier","pixelated","getContext","focus","ratio","devicePixelRatio","floor","style","sharp","imageRendering","imageSmoothingEnabled","Loop","framerate","speed","elapsedTime","lastUpdate","paused","currentUpdate","performance","now","requestAnimationFrame","pause","play","tick","times","preloadAssets","require","promiseArray","assetsLoaded","assetLoaded","find","asset","index","substring","Image","sound","Audio","oncanplaythrough","cloneNode","loadAsset","assets","preloadModels","modelsLoaded","componentLoaded","loadModel","default","preloadScenes","config","expose","offsetHeight","offsetWidth","loading","restarting","updates","forward","timeframe","playing","scene","$","snippets","version","restart","loop","promisePreloadAssets","promisePreloadModels","theatre","body","querySelector"],"mappings":"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","file":"index.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t};\n\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"\" + chunkId + \".index.js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 25);\n","const loadRenderers=function(sceneRenderers){\r\n  if(sceneRenderers){\r\n      sceneRenderers.forEach((renderer) => {\r\n      var rendererSystem=getSystem.call(this,renderer.name,renderer.scope);\r\n      this.$world.system(renderer.components, rendererSystem);\r\n    });\r\n  }\r\n}\r\n\r\nconst getRenderers=function(){\r\n  try{\r\n    let sceneModel=this.models.scenes[this.currentScene];\r\n    if(sceneModel!==undefined && sceneModel.renderers!=undefined && sceneModel.renderers() ){\r\n      return sceneModel.renderers();\r\n    }else return[];\r\n  }catch(err){\r\n    console.error(\"no renderers found for this scene :\"+this.currentScene);\r\n  }\r\n}\r\n\r\nconst getSystem=function(systemName,systemScope){\r\n  try{\r\n    if(typeof systemName!==\"string\"|| systemName===\"\"){\r\n      throw \"no system name defined\"\r\n    }\r\n    return this.models.systems[systemScope][systemName]()[systemName];\r\n    //return require('components/common/'+componentRef.name+'.json');\r\n  }catch(err){\r\n    throw \"no system found with name :\"+systemName;\r\n  }\r\n}\r\n\r\nexport {loadRenderers,getRenderers};\r\n","const loadSystems=function(sceneSystems){\r\n  sceneSystems.forEach((system) => {\r\n    var updateSystem=getSystem.call(this,system.name,system.scope);\r\n    this.$world.system(system.components, updateSystem);\r\n  });\r\n}\r\n\r\nconst getSystems=function(){\r\n  try{\r\n    let sceneModel=this.models.scenes[this.currentScene];\r\n    if(sceneModel!==undefined && sceneModel.systems!=undefined && sceneModel.systems() ){\r\n      return sceneModel.systems();\r\n    }else return[];\r\n  }catch(err){\r\n    console.error(\"no systems found for this scene :\"+this.currentScene)\r\n  }\r\n}\r\nconst getSystem=function(systemName,systemScope){\r\n  try{\r\n    if(typeof systemName!==\"string\"|| systemName===\"\"){\r\n      throw \"no system name defined\"\r\n    }\r\n    var systemModule=this.models.systems[systemScope][systemName]();\r\n    if(systemModule[systemName]){\r\n      return systemModule[systemName];\r\n    }else throw \"system don't export good systemName\";\r\n    //return require('components/common/'+componentRef.name+'.json');\r\n  }catch(err){\r\n    throw \"no system found with name :\"+systemName;\r\n  }\r\n}\r\n\r\nexport {loadSystems,getSystems};\r\n","import {Entity} from 'modules/world.js';\r\n\r\n\r\nconst cloneArray = function (a, fn) {\r\n  var keys = Object.keys(a)\r\n  var a2 = new Array(keys.length)\r\n  for (var i = 0; i < keys.length; i++) {\r\n    var k = keys[i]\r\n    var cur = a[k]\r\n    if (typeof cur !== 'object' || cur === null) {\r\n      a2[k] = cur\r\n    } else {\r\n      a2[k] = fn(cur)\r\n    }\r\n  }\r\n  return a2\r\n};\r\n\r\nconst cloneProto=function (o) {\r\n  if (typeof o !== 'object' || o === null) return o;\r\n  if (Array.isArray(o)) return cloneArray(o, cloneProto)\r\n  var o2 = {}\r\n  for (var k in o) {\r\n    var cur = o[k]\r\n    if (typeof cur !== 'object' || cur === null) {\r\n      o2[k] = cur\r\n    } else {\r\n      o2[k] = cloneProto(cur)\r\n    }\r\n  }\r\n  return o2\r\n}\r\n\r\nconst loadRef=function(value){\r\n  try{\r\n    var ref=\"\";\r\n    value.split(\".\").forEach((path,i) => {\r\n      if(i==0){\r\n        ref=this[path]\r\n      }else{\r\n        ref=ref[path];\r\n      }\r\n    });\r\n    return ref\r\n  }catch(err){\r\n    throw err;\r\n  }\r\n}\r\n\r\nconst createNewParamsFromModel=function(paramsModel,params,deep=0){\r\n  try{\r\n    var newParams={};\r\n    var keysParamsModel=Object.keys(paramsModel);\r\n    for (var i = 0; i < keysParamsModel.length; i++) {\r\n      var keyModel=keysParamsModel[i];\r\n      var modelNewParam=paramsModel[keyModel];\r\n      var valueParam=params[keyModel];\r\n\r\n      if(valueParam==undefined){\r\n        if(modelNewParam._default==undefined){\r\n          throw \"error missing parameter :\"+keyModel;\r\n        }else{\r\n          var defaultValue=JSON.parse(JSON.stringify(modelNewParam._default));\r\n          if(modelNewParam._type===\"ref\"){\r\n            defaultValue=loadRef.call(this,defaultValue);\r\n          }\r\n          newParams[keyModel]=defaultValue;\r\n        }\r\n      }else {\r\n        if(modelNewParam._type.startsWith(\"array\") && Array.isArray(valueParam)){\r\n          newParams[keyModel]=[]\r\n          var arraySubType=modelNewParam._type.match(\"array<(.*)>\")[1];\r\n          if(arraySubType===\"array\"){\r\n              for (var c = 0; c < valueParam.length; c++) {\r\n                var arrayObject=createNewParamsFromModel.call(this,{array:modelNewParam[\"_\"+arraySubType]},{array:valueParam[c]});\r\n                newParams[keyModel].push(arrayObject[\"array\"]);\r\n              }\r\n          }else if(arraySubType===\"object\"){\r\n            for (var c = 0; c < valueParam.length; c++) {\r\n              newParams[keyModel].push(createNewParamsFromModel.call(this,modelNewParam[\"_\"+arraySubType],valueParam[c]));\r\n            }\r\n          }else if(arraySubType===\"string\"||arraySubType===\"number\"||arraySubType===\"boolean\"){\r\n            for (var c = 0; c < valueParam.length; c++) {\r\n              if(arraySubType!=typeof valueParam[c]){\r\n                throw \"wrong subType\"+arraySubType+\"in array model for param :\"+keyModel;\r\n              }\r\n              newParams[keyModel].push(valueParam[c]);\r\n            }\r\n          }else {\r\n            throw \"missing/wrong subType\"+arraySubType+\"in array model for param :\"+keyModel;\r\n          }\r\n        }else if(modelNewParam._type===\"object\" && typeof valueParam ===\"object\" && !Array.isArray(valueParam)){\r\n          newParams[keyModel]={}\r\n          var modelNewParamKeys= Object.keys(modelNewParam).filter(key=>!key.startsWith('_'));\r\n          for (var c = 0; c < modelNewParamKeys.length; c++) {\r\n            var modelNewParamKey=modelNewParamKeys[c]\r\n            var valueParamOfKey=valueParam[modelNewParamKey]?valueParam[modelNewParamKey]:{};\r\n            var newParamObject=createNewParamsFromModel.call(this,{[modelNewParamKey]:modelNewParam[modelNewParamKey]},{[modelNewParamKey]:valueParamOfKey});\r\n            newParams[keyModel][modelNewParamKey]=newParamObject[modelNewParamKey];\r\n          }\r\n        }else if(modelNewParam._type===typeof valueParam){\r\n          newParams[keyModel]=valueParam;\r\n        }else if(modelNewParam._type===\"ref\" && typeof valueParam ===\"string\" ){\r\n          newParams[keyModel]=loadRef.call(this,valueParam);\r\n        }else{\r\n          throw \"error wrong type parameters for \"+keyModel+\": waiting \"+modelNewParam._type+\" and get \"+typeof valueParam;\r\n        }\r\n      }\r\n    }\r\n    return newParams;\r\n  }catch(err){\r\n    throw err;\r\n  }\r\n};\r\n\r\nconst mergeDeep=(...objects)=> {\r\n  const isObject = obj => obj && typeof obj === 'object';\r\n\r\n  return objects.reduce((prev, obj) => {\r\n    Object.keys(obj).forEach(key => {\r\n      const pVal = prev[key];\r\n      const oVal = obj[key];\r\n\r\n      if (Array.isArray(pVal) && Array.isArray(oVal)) {\r\n        prev[key] = pVal.concat(...oVal);\r\n        //prev[key] = pVal;\r\n      }\r\n      else if (isObject(pVal) && isObject(oVal)) {\r\n        prev[key] = mergeDeep(pVal, oVal);\r\n      }\r\n      else {\r\n        prev[key] = oVal;\r\n      }\r\n    });\r\n\r\n    return prev;\r\n  }, {});\r\n}\r\n\r\n\r\nconst convertArrayToObject = (array, key) => {\r\n  const initialValue = {};\r\n  return array.reduce((obj, item) => {\r\n    return {\r\n      ...obj,\r\n      [item[key]]: item,\r\n    };\r\n  }, initialValue);\r\n};\r\n\r\nconst getEntitiesScene=function(){\r\n  try{\r\n    let currentScene=this.models.scenes[this.currentScene];\r\n    if(currentScene && currentScene.entities){\r\n      return currentScene.entities();\r\n    }\r\n  }catch(err){\r\n    console.error(\"no entities found for this scene :\"+this.currentScene)\r\n  }\r\n}\r\n\r\nconst getCachedEntity=function(entityRef){\r\n  let cacheScope=this.cachedEntities[entityRef.scope];\r\n  return cacheScope?(cacheScope[entityRef.name]?cloneProto(cacheScope[entityRef.name]):null):null;\r\n}\r\n\r\nconst setCachedEntity=function(entityRef,entityGenerated){\r\n  if(!this.cachedEntities[entityRef.scope]){\r\n      this.cachedEntities[entityRef.scope]={};\r\n    }\r\n    this.cachedEntities[entityRef.scope][entityRef.name]=cloneProto(entityGenerated);\r\n}\r\n\r\nconst generateEntities=function(sceneEntities){\r\n  try{\r\n    var entities=[];\r\n    sceneEntities.forEach((entityRef) => {\r\n      //let newEntity=getCachedEntity.call(this,entityRef);\r\n      let newEntity=null;\r\n      if(!newEntity){\r\n        var entityDef=getEntityDefinition.call(this,entityRef);\r\n        var componentsOverride=convertArrayToObject(entityRef.components,'name');\r\n        var componentsModel=convertArrayToObject(entityDef.components,'name');\r\n        var newEntityComponents=mergeDeep(componentsModel,componentsOverride);\r\n        newEntity=generateEntityModel.call(this,{name:entityDef.name,components:Object.values(newEntityComponents)});\r\n        newEntity=new Entity(newEntity.name,newEntity.components);\r\n        setCachedEntity.call(this,entityRef,newEntity);\r\n      }\r\n      entities.push(newEntity);\r\n    });\r\n    return entities;\r\n  }catch(err){\r\n    console.error(err);\r\n  }\r\n}\r\n\r\n\r\nconst generateEntityModel=function(entityModelOverride){\r\n  try{\r\n    var loadedEntity={name:entityModelOverride.name,components:[]};\r\n    entityModelOverride.components.forEach((component) => {\r\n      var newComponent=createComponentFromModel.call(this,component);\r\n      loadedEntity.components.push(newComponent);\r\n    });\r\n    return loadedEntity;\r\n  }catch(err){\r\n    throw err;\r\n  }\r\n}\r\n\r\nconst createComponentFromModel=function(componentRef){\r\n  try{\r\n    var componentModel=getComponentModel.call(this,componentRef);\r\n    var params=componentRef.params?componentRef.params:{};\r\n    var newComponent=createNewParamsFromModel.call(this,componentModel.params,params);\r\n    newComponent.name=componentModel.name;\r\n    return newComponent;\r\n  }catch(err){\r\n    throw err;\r\n  }\r\n}\r\n\r\nconst getEntityDefinition=function(entityRef){\r\n  try{\r\n    if(typeof entityRef.name!==\"string\"|| entityRef.name===\"\"||typeof entityRef.scope!==\"string\" ||entityRef.scope===\"\" ){\r\n      throw \"no entity name defined\"\r\n    }\r\n    return this.models.entities[entityRef.scope][entityRef.name]();\r\n  }catch(err){\r\n    throw \"no entity found with name :\"+entityRef.name+\" and scope :\"+entityRef.scope;\r\n  }\r\n}\r\n\r\nconst getComponentModel=function(componentRef){\r\n  try{\r\n    if(typeof componentRef.name!==\"string\"|| componentRef.name===\"\"||typeof componentRef.scope!==\"string\" ||componentRef.scope===\"\"){\r\n      throw \"no component name defined\"\r\n    }\r\n    return this.models.components[componentRef.scope][componentRef.name]();\r\n  }catch(err){\r\n    throw \"no component found with name :\"+componentRef.name+\" and scope :\"+componentRef.scope;\r\n  }\r\n}\r\n\r\nconst loadEntities=function(){\r\n  var sceneEntities=getEntitiesScene.call(this);\r\n  return generateEntities.call(this,sceneEntities);\r\n}\r\n\r\nexport {loadEntities,generateEntities,createComponentFromModel};\r\n","function Entity(name, components) {\n\n    function add(components) {\n\n        if (Array.isArray(components) === false) {\n\n            components = [components];\n        }\n\n        components.forEach((component) => {\n\n            this.components[component.name] = component;\n        });\n    }\n\n    function get(component) {\n\n        return this.components[component];\n    }\n\n    function has(components) {\n\n        if (Array.isArray(components) === false) {\n\n            components = [components];\n        }\n\n        for (let iterator = 0, length = components.length; iterator < length; iterator += 1) {\n\n            const search = components[iterator];\n            const component = search.replace('not:', '');\n            const exclude = search !== component;\n\n            if (this.components.hasOwnProperty(component) === exclude) {\n\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    function remove(components) {\n\n        if (Array.isArray(components) === false) {\n\n            components = [components];\n        }\n\n        for (let iterator = 0, length = components.length; iterator < length; iterator += 1) {\n\n            const component = components[iterator];\n\n            if (this.components.hasOwnProperty(component) === true) {\n\n                delete this.components[component];\n            }\n        }\n    }\n\n    this.components = {};\n    this.name = name;\n\n    this.add = add;\n    this.get = get;\n    this.has = has;\n    this.remove = remove;\n\n    this.add(components);\n}\n\nfunction World(context) {\n\n    function add(entities) {\n\n        if (Array.isArray(entities) === false) {\n\n            entities = [entities];\n        }\n\n        entities.forEach((entity) => {\n\n            this.entities[entity.name] = entity;\n        });\n    }\n\n    function get(entity) {\n\n        return this.entities[entity];\n    }\n\n    function remove(entities) {\n\n        if (Array.isArray(entities) === false) {\n\n            entities = [entities];\n        }\n\n        for (let iterator = 0, length = entities.length; iterator < length; iterator += 1) {\n\n            const entity = entities[iterator];\n            const key = entity.name || entity;\n\n            if (this.entities.hasOwnProperty(key) === true) {\n\n                delete this.entities[key];\n            }\n        }\n    }\n\n    function system(components, handler, entities = this.entities) {\n\n        const chosen = {};\n\n        Object.entries(entities).forEach(([name, entity]) => {\n\n            if (entity.has(components) === true) {\n\n                chosen[name] = entity;\n            }\n        });\n\n        handler.call(context, chosen);\n    }\n\n    this.entities = {};\n\n    this.add = add;\n    this.get = get;\n    this.remove = remove;\n    this.system = system;\n}\n\nexport {\n\n    // exports current module as an object\n    World,\n\n    // exports helpers for current module\n    Entity\n};\n","function easeIn(power) {\n\n    // accelerating from zero velocity\n    return (x) => x ** power;\n}\n\nfunction easeInOut(power) {\n\n    // acceleration until halfway, then deceleration (with x in [0, 1] range)\n    return (x) => {\n\n        if (x < 0.5) {\n\n            return easeIn(power)(2 * x) / 2\n        }\n\n        return 1 - easeInOut(power)(1 - x)\n    }\n}\n\nfunction easeOut(power) {\n\n    // decelerating to zero velocity (with x in [0, 1] range)\n    return (x) => 1 - easeIn(power)(1 - x);\n}\n\nfunction linear(factor) {\n\n    // linear progression\n    return (x) => x * factor;\n}\n\nfunction easeInQuad(x) {\n\n    // accelerating from zero velocity\n    return easeIn(2)(x);\n}\n\nfunction easeInCubic(x) {\n\n    // accelerating from zero velocity\n    return easeIn(3)(x);\n}\n\nfunction easeInQuart(x) {\n\n    // accelerating from zero velocity\n    return easeIn(4)(x);\n}\n\nfunction easeInOutQuad(x) {\n\n    // acceleration until halfway, then deceleration (with x in [0, 1] range)\n    return easeInOut(2)(x);\n}\n\nfunction easeInOutCubic(x) {\n\n    // acceleration until halfway, then deceleration (with x in [0, 1] range)\n    return easeInOut(3)(x);\n}\n\nfunction easeInOutQuart(x) {\n\n    // acceleration until halfway, then deceleration (with x in [0, 1] range)\n    return easeInOut(4)(x);\n}\n\nfunction easeOutQuad(x) {\n\n    // decelerating to zero velocity (with x in [0, 1] range)\n    return easeOut(2)(x);\n}\n\nfunction easeOutCubic(x) {\n\n    // decelerating to zero velocity (with x in [0, 1] range)\n    return easeOut(3)(x);\n}\n\nfunction easeOutQuart(x) {\n\n    // decelerating to zero velocity (with x in [0, 1] range)\n    return easeOut(4)(x);\n}\n\nfunction reverse(handler) {\n\n    // reversing easing function\n    return (x) => handler(1 - x);\n}\n\n// exports current module as functions\nexport {\n\n    // export ease function creators\n    easeIn, easeInOut, easeOut, linear,\n\n    // export ease-in functions\n    easeInCubic, easeInQuad, easeInQuart,\n\n    // export ease-in-out functions\n    easeInOutCubic, easeInOutQuad, easeInOutQuart,\n\n    // export ease-out functions\n    easeOutCubic, easeOutQuad, easeOutQuart,\n\n    // export utility functions\n    reverse\n};\n","import {generateEntities} from 'core/loadEntities.js';\r\n\r\nfunction generateDecor(entities) {\r\n\r\n    let birdPosition=this.$world.entities.character.get('position').x;\r\n    let maxPosBeyondBird=birdPosition+128;\r\n    let minPosition=birdPosition-32;\r\n    let entitiesName=[\"top\",\"bottom\",\"background\",\"water\",\"pipeTop\",\"pipeBottom\",\"cloud\"];\r\n\r\n    if(this.$infos.started){\r\n      entitiesName.push(\"checkpoint\")\r\n    }\r\n\r\n    let decorEntities={};\r\n    for (var i = 0; i < entitiesName.length; i++) {\r\n      let name=entitiesName[i];\r\n      decorEntities[name]={'model':this.models.entities.demo[name],'width':64,'maxPosition':minPosition,'maxId':0,'entities':[]}\r\n    }\r\n\r\n    decorEntities[\"cloud\"].width=160;\r\n\r\n    Object.entries(entities).filter(([name,entity])=>{\r\n\r\n      let entityName=name.match(/^([a-zA-Z]+)/)[1];\r\n      let isOut=(entity.get('position').x+decorEntities[entityName].width)<minPosition;\r\n      if(isOut){\r\n        this.$world.remove(entity);\r\n      }else{\r\n        let entityId=name.match(/^[a-zA-Z]+([0-9]+)/)[1];\r\n        decorEntities[entityName].entities.push(entity);\r\n        if(decorEntities[entityName].maxPosition<(entity.get('position').x+decorEntities[entityName].width)){\r\n            decorEntities[entityName].maxPosition=entity.get('position').x+decorEntities[entityName].width;\r\n            decorEntities[entityName].maxId=parseInt(entityId)+1;\r\n        }\r\n      }\r\n      return !isOut;\r\n    });\r\n\r\n\r\n    if(this.$infos.started && decorEntities['checkpoint'].entities.length===0){\r\n      let maxPosPipe=decorEntities['pipeTop'].maxPosition;\r\n      decorEntities['checkpoint'].maxPosition=maxPosPipe;\r\n    }\r\n\r\n\r\n    Object.entries(decorEntities).forEach(([name,entityInfo])=>{\r\n      while(maxPosBeyondBird>entityInfo.maxPosition){\r\n        let newEntities=generateEntities.call(this,[entityInfo.model()]);\r\n        newEntities.map((newEntity)=>{\r\n          newEntity.name=newEntity.name+entityInfo.maxId;\r\n          newEntity.get('position').x=entityInfo.maxPosition;\r\n          this.$world.add(newEntity);\r\n        });\r\n        entityInfo.maxPosition=entityInfo.maxPosition+entityInfo.width;\r\n        entityInfo.maxId=entityInfo.maxId+1;\r\n      }\r\n    });\r\n}\r\n\r\nexport {generateDecor};\r\n","function Circle(x, y, radius) {\n\n    this.radius = radius;\n    this.x = x;\n    this.y = y;\n}\n\nfunction Point(x, y) {\n\n    this.x = x;\n    this.y = y;\n}\n\nfunction Rectangle(x, y, width, height) {\n\n    this.height = height;\n    this.width = width;\n    this.x = x;\n    this.y = y;\n}\n\nfunction Segment(xa, ya, xb, yb) {\n\n    this.xa = xa;\n    this.xb = xb;\n    this.ya = ya;\n    this.yb = yb;\n}\n\n// exports current module as objects\nexport {Circle, Point, Rectangle, Segment};\n","module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","//import {debug} from 'systems/common/debug.js';\r\n\r\nfunction after() {\r\n\r\n    // console.log('lifecycle :', 'after demo scene');\r\n\r\n    /*this.$.world.system('debug', [], debug);\r\n\r\n    this.$.controllers.inputs.length = 0;*/\r\n  this.$controllers.inputs.length = 0;\r\n\r\n}\r\n\r\nexport {after};\r\n","function before() {\r\n\r\n}\r\n\r\nexport {before};\r\n","function destroy() {\n\n    console.log('destroy demo scene');\n    console.log('-------');\n\n    this.$controllers.destroy();\n\n    delete this.$camera;\n    delete this.$controllers;\n    delete this.$origins;\n    delete this.$world.entities;\n    delete this.$world;\n    delete this.$systems;\n    delete this.$renderers;\n}\n\nexport {destroy};\n","//import {fade} from 'systems/common/fade.js';\nimport {loadRenderers} from 'core/loadRenderers';\nimport {showHitbox} from 'systems/common/showHitbox';\nfunction render() {\n    // console.log('render demo scene');\n\n    this.context.fillStyle = '#000000';\n    this.context.fillRect(0, 0, this.size.width, this.size.height);\n\n    loadRenderers.call(this,this.$renderers);\n\n    this.$camera.render();\n    this.$cameraInfo.render();\n//    this.$world.system([\"camera\", \"hitbox\", \"origin\", \"position\"], showHitbox);\n\n}\n\nexport {render};\n","import {Rectangle} from 'modules/shape.js';\r\n\r\nfunction showHitbox(entities) {\r\n\r\n  Object.entries(entities).forEach(([name, entity]) => {\r\n\r\n    const cameraComponent = entity.get('camera');\r\n    const hitboxComponent = entity.get('hitbox');\r\n    const originComponent = entity.get('origin');\r\n    const positionComponent = entity.get('position');\r\n\r\n    const $camera = cameraComponent.camera;\r\n    const $origin = originComponent.reference\r\n\r\n    const hitbox = new Rectangle(\r\n\r\n        $camera.screen.x() + (positionComponent.x + hitboxComponent.x) * $camera.screen.scale() - ($camera.position.x() * $camera.screen.scale() - $camera.screen.width() / 2 + $camera.shaking.shift.x * $camera.screen.scale()),\r\n        $camera.screen.y() + (positionComponent.y + hitboxComponent.y) * $camera.screen.scale() - ($camera.position.y() * $camera.screen.scale() - $camera.screen.height() / 2 + $camera.shaking.shift.y * $camera.screen.scale()),\r\n        hitboxComponent.width * $camera.screen.scale(),\r\n        hitboxComponent.height * $camera.screen.scale()\r\n    );\r\n\r\n    const width = 2;\r\n    const offset = width / 2;\r\n\r\n    this.context.save();\r\n\r\n    this.context.lineWidth = width;\r\n\r\n    this.context.strokeStyle = '#639bff';\r\n\r\n    this.context.strokeRect(hitbox.x + offset, hitbox.y + offset, hitbox.width - width, hitbox.height - width);\r\n\r\n    this.context.restore();\r\n  });\r\n};\r\n\r\nexport {showHitbox};\r\n","function resize() {\n\n    console.log('resize demo scene');\n\n    /*this.$camera.screen.height = ()=>{this.size.height};\n    this.$camera.screen.width = ()=>{ this.size.width};*/\n\n    //this.$origins.default.x = this.size.width / 2;\n    //this.$origins.default.y = this.size.height / 2;\n    // this.$origins.default.z = 0;\n    // this.$origins.default.scale = 1;\n}\n\nexport {resize};\n","function setup() {\n\n    console.log('setup demo scene');\n\n\n}\n\nexport {setup};\n","import {loadSystems} from \"core/loadSystems\";\n\nfunction update() {\n\n    loadSystems.call(this,this.$systems);\n    this.$camera.update(this.delta.update);\n}\n\nexport {update};\n","function after() {\r\n\r\n}\r\n\r\nexport {after};\r\n","//import {inputs} from 'systems/common/inputs.js';\r\n\r\nfunction before() {\r\n\r\n    // console.log('lifecycle :', 'before demo scene');\r\n/*\r\n    this.$.controllers.inputs.forEach((input) => {\r\n\r\n        // console.log('debugging :', input);\r\n    });\r\n\r\n    this.$.world.system('inputs', ['inputs'], inputs);*/\r\n}\r\n\r\nexport {before};\r\n","function destroy() {\n\n    console.log('destroy loading scene');\n    console.log('-------');\n\n    delete this.state.redirect;\n    delete this.$systems;\n    delete this.$renderers;\n}\n\nexport {destroy};\n","import {loadRenderers} from 'core/loadRenderers';\n\nfunction render() {\n\n    // console.log('render loading scene');\n\n    loadRenderers.call(this,this.$renderers);\n\n    this.context.fillStyle = '#181a1f';\n    this.context.fillRect(0, 0, this.size.width, this.size.height);\n\n    this.context.font = '16px Courier New';\n    this.context.textAlign = 'start';\n    this.context.textBaseline = 'top';\n    this.context.fillStyle = '#6b717d';\n    this.context.fillText('/ Theatre', 8, 8);\n    this.context.fillStyle = '#d7dae0';\n\n    this.context.fillText('$ preloading assets...', 8, 32);\n\n    if (this.preloading === false) {\n\n        this.context.fillText('$ preloading completed', 8, 32 + 24);\n        this.context.fillText('$ loading demo scene...', 8, 32 + 24 + 24);\n    }\n}\n\nexport {render};\n","function resize() {\n\n    console.log('resize loading scene');\n}\n\nexport {resize};\n","import {getRenderers} from 'core/loadRenderers';\nimport {getSystems} from 'core/loadSystems';\n\nfunction setup() {\n\n    console.log('setup loading scene');\n    this.$renderers=getRenderers.call(this);\n    this.$systems=getSystems.call(this);\n}\n\nexport {setup};\n","function start() {\n\n    console.log('start loading scene');\n\n    this.state.redirect = false;\n}\n\nexport {start};\n","function update() {\n\n    // console.log('update loading scene');\n\n    if (this.preloading === false && this.state.redirect === false) {\n\n        setTimeout(() => {\n\n            this.load('demo');\n\n        }, 100);\n\n        this.state.redirect = true;\n    }\n}\n\nexport {update};\n","import * as Ease from './ease.js';\n\nfunction Camera(context, name, screen) {\n\n    let images = [];\n\n    let shaking = {\n\n        'current': false,\n        'duration': 0,\n        'easing': null,\n        'elapsed': 0,\n        'force': {\n\n            'x': 0,\n            'y': 0\n        },\n        'shift': {\n\n            'x': 0,\n            'y': 0\n        }\n    };\n\n    function add(image) {\n\n        let target = 0;\n\n        for (let iterator = images.length - 1; iterator >= 0; iterator -= 1) {\n\n            const current = images[iterator];\n\n            if (image.destination.z > current.destination.z\n            || image.destination.z === current.destination.z\n            && image.destination.y >= current.destination.y) {\n\n                target = iterator + 1;\n\n                break;\n            }\n        }\n\n        images.splice(target, 0, image);\n    }\n\n    function idle() {\n\n        this.shaking = {\n\n            'current': false,\n            'duration': 0,\n            'easing': null,\n            'elapsed': 0,\n            'force': {\n\n                'x': 0,\n                'y': 0\n            },\n            'shift': {\n\n                'x': 0,\n                'y': 0\n            }\n        };\n    }\n\n    function look(x, y) {\n\n        this.position.x = x;\n        this.position.y = y;\n    }\n\n    function render() {\n\n        images.forEach((image) => {\n\n            const {destination, frame, opacity, source} = image;\n\n            const visible = this.visible(\n\n                destination.x * this.screen.scale(),\n                destination.y * this.screen.scale(),\n                destination.width * this.screen.scale(),\n                destination.height * this.screen.scale()\n            );\n\n            if (opacity > 0\n            && visible === true) {\n\n                const alpha = context.globalAlpha;\n\n                context.globalAlpha = opacity;\n\n                const canvas = {\n\n                    'destination': {\n\n                        'x': this.screen.x() + destination.x * this.screen.scale() - (this.position.x() * this.screen.scale() - this.screen.width() / 2 + this.shaking.shift.x * this.screen.scale()),\n                        'y': this.screen.y() + destination.y * this.screen.scale() - (this.position.y() * this.screen.scale() - this.screen.height() / 2 + this.shaking.shift.y * this.screen.scale()),\n                        'width': destination.width * this.screen.scale(),\n                        'height': destination.height * this.screen.scale()\n                    }\n                };\n\n                const offset = {\n\n                    'top': Math.min(0, canvas.destination.y - this.screen.y()),\n                    'right': Math.max(0, canvas.destination.x + canvas.destination.width - (this.screen.x() + this.screen.width())),\n                    'bottom': Math.max(0, canvas.destination.y + canvas.destination.height - (this.screen.y() + this.screen.height())),\n                    'left': Math.min(0, canvas.destination.x - this.screen.x())\n                };\n\n                context.drawImage(\n\n                    source,\n                    frame.x - offset.left * (frame.width / canvas.destination.width),\n                    frame.y - offset.top * (frame.height / canvas.destination.height),\n                    frame.width - offset.right * (frame.width / canvas.destination.width) - Math.abs(offset.left * (frame.width / canvas.destination.width)),\n                    frame.height - offset.bottom * (frame.height / canvas.destination.height) - Math.abs(offset.top * (frame.height / canvas.destination.height)),\n                    canvas.destination.x - offset.left,\n                    canvas.destination.y - offset.top,\n                    canvas.destination.width - offset.right - Math.abs(offset.left),\n                    canvas.destination.height - offset.bottom - Math.abs(offset.top)\n                );\n\n                context.globalAlpha = alpha;\n            }\n        });\n\n        images = [];\n    }\n\n    function shake(x, y, duration, easing = Ease.reverse(Ease.easeOut(2))) {\n\n        this.idle();\n\n        this.shaking.force = {\n\n            'x': x,\n            'y': y\n        };\n\n        this.shaking.current = true;\n        this.shaking.duration = duration;\n        this.shaking.easing = easing;\n    }\n\n    function update(delta) {\n\n        if (this.shaking.current === false) {\n\n            return;\n        }\n\n        if (this.shaking.elapsed + delta >= this.shaking.duration) {\n\n            this.idle();\n\n            return;\n        }\n\n        this.shaking.elapsed += delta;\n\n        const amplitude = this.shaking.easing(this.shaking.elapsed / this.shaking.duration);\n        const angle = Math.random() * 2 * Math.PI;\n\n        this.shaking.shift.x = Math.round(Math.cos(angle) * this.shaking.force.x * amplitude);\n        this.shaking.shift.y = Math.round(Math.sin(angle) * this.shaking.force.y * amplitude);\n    }\n\n    function visible(x, y, width, height) {\n\n        const camera = {\n\n            'x': this.position.x() * this.screen.scale() - this.screen.width() / 2 + this.shaking.shift.x * this.screen.scale(),\n            'y': this.position.y() * this.screen.scale() - this.screen.height() / 2 + this.shaking.shift.y * this.screen.scale(),\n            'width': this.screen.width(),\n            'height': this.screen.height()\n        };\n\n        if (x + width <= camera.x\n        || x >= camera.x + camera.width\n        || y + height <= camera.y\n        || y >= camera.y + camera.height) {\n\n            return false;\n        }\n\n        return true;\n    }\n\n    this.name = name;\n\n    this.position = {\n\n        'x': () => 0,\n        'y': () => 0\n    };\n\n    this.screen = {\n\n        'x': screen.x,\n        'y': screen.y,\n        'width': screen.width,\n        'height': screen.height,\n        'scale': screen.scale\n    };\n\n    this.shaking = shaking;\n\n    this.add = add;\n    this.idle = idle;\n    this.look = look;\n    this.render = render;\n    this.shake = shake;\n    this.update = update;\n    this.visible = visible;\n}\n\n// exports current module as an object\nexport {Camera};\n","const keynames = [];\n\nkeynames[9] = 'TAB';\nkeynames[13] = 'ENTER';\nkeynames[16] = 'SHIFT';\nkeynames[17] = 'CTRL';\nkeynames[18] = 'ALT';\nkeynames[27] = 'ESC';\nkeynames[32] = 'SPACE';\n\nkeynames[37] = 'LEFT';\nkeynames[38] = 'UP';\nkeynames[39] = 'RIGHT';\nkeynames[40] = 'DOWN';\n\nkeynames[48] = 'ZERO';\nkeynames[49] = 'ONE';\nkeynames[50] = 'TWO';\nkeynames[51] = 'THREE';\nkeynames[52] = 'FOUR';\nkeynames[53] = 'FIVE';\nkeynames[54] = 'SIX';\nkeynames[55] = 'SEVEN';\nkeynames[56] = 'EIGHT';\nkeynames[57] = 'NINE';\n\nkeynames[65] = 'A';\nkeynames[66] = 'B';\nkeynames[67] = 'C';\nkeynames[68] = 'D';\nkeynames[69] = 'E';\nkeynames[70] = 'F';\nkeynames[71] = 'G';\nkeynames[72] = 'H';\nkeynames[73] = 'I';\nkeynames[74] = 'J';\nkeynames[75] = 'K';\nkeynames[76] = 'L';\nkeynames[77] = 'M';\nkeynames[78] = 'N';\nkeynames[79] = 'O';\nkeynames[80] = 'P';\nkeynames[81] = 'Q';\nkeynames[82] = 'R';\nkeynames[83] = 'S';\nkeynames[84] = 'T';\nkeynames[85] = 'U';\nkeynames[86] = 'V';\nkeynames[87] = 'W';\nkeynames[88] = 'X';\nkeynames[89] = 'Y';\nkeynames[90] = 'Z';\n\n// exports current module as an array\nexport {keynames};\n","import {keynames} from './keynames.js';\n\nfunction Keyboard(container, actions, inputs) {\n\n    const states = {};\n\n    function blur() {\n\n        for (let state in states) {\n\n            if (states.hasOwnProperty(state)\n            && states[state] === true) {\n\n                states[state] = false;\n\n                inputs.push({\n\n                    'type': 'KEYBOARD',\n                    'action': state,\n                    'state': 'UP'\n                });\n            }\n        }\n    }\n\n    function destroy() {\n\n        container.removeEventListener('blur', blur);\n        container.removeEventListener('keydown', keydown);\n        container.removeEventListener('keyup', keyup);\n    }\n\n    function keydown(event) {\n\n        const action = 'KEY_' + keynames[event.keyCode];\n\n        if (actions.indexOf(action) !== -1\n        && states[action] === false) {\n\n            event.preventDefault();\n\n            states[action] = true;\n\n            inputs.push({\n\n                'type': 'KEYBOARD',\n                'action': action,\n                'state': 'DOWN'\n            });\n        }\n    }\n\n    function keyup(event) {\n\n        const action = 'KEY_' + keynames[event.keyCode];\n\n        if (actions.indexOf(action) !== -1\n        && states[action] === true) {\n\n            event.preventDefault();\n\n            states[action] = false;\n\n            inputs.push({\n\n                'type': 'KEYBOARD',\n                'action': action,\n                'state': 'UP'\n            });\n        }\n    }\n\n    function setup() {\n\n        container.addEventListener('blur', blur);\n        container.addEventListener('keydown', keydown);\n        container.addEventListener('keyup', keyup);\n    }\n\n    actions.forEach((action) => {\n\n        states[action] = false;\n    });\n\n    setup.call(this);\n\n    this.destroy = destroy;\n    this.setup = setup;\n}\n\n// exports current module as an object\nexport {Keyboard};\n","function Mouse(container, actions, inputs) {\n\n    function contextmenu(event) {\n\n        const action = 'CLICK_RIGHT';\n\n        if (actions.indexOf(action) !== -1) {\n\n            event.preventDefault();\n        }\n    }\n\n    function destroy() {\n\n        container.removeEventListener('contextmenu', contextmenu);\n        container.removeEventListener('mousedown', mousedown);\n        container.removeEventListener('mouseenter', mouseenter);\n        container.removeEventListener('mouseleave', mouseleave);\n        container.removeEventListener('mousemove', mousemove);\n        container.removeEventListener('mouseup', mouseup);\n        container.removeEventListener('wheel', wheel);\n    }\n\n    function mousedown(event) {\n\n        const button = event.button;\n        const buttons = ['LEFT', 'MIDDLE', 'RIGHT'];\n\n        if (typeof buttons[button] === 'undefined') {\n\n            return;\n        }\n\n        const action = 'CLICK_' + buttons[button];\n\n        if (actions.indexOf(action) !== -1) {\n\n            event.preventDefault();\n\n            const rectangle = event.target.getBoundingClientRect();\n            const x = event.clientX - rectangle.left;\n            const y = event.clientY - rectangle.top;\n\n            inputs.push({\n\n                'type': 'MOUSE',\n                'action': action,\n                'state': 'DOWN',\n                'x': x,\n                'y': y\n            });\n        }\n    }\n\n    function mouseenter(event) {\n\n        const action = 'MOVE';\n\n        if (actions.indexOf(action) !== -1) {\n\n            event.preventDefault();\n\n            const rectangle = event.target.getBoundingClientRect();\n            const x = event.clientX - rectangle.left;\n            const y = event.clientY - rectangle.top;\n\n            inputs.push({\n\n                'type': 'MOUSE',\n                'action': action,\n                'state': 'ENTER',\n                'x': x,\n                'y': y\n            });\n        }\n    }\n\n    function mouseleave(event) {\n\n        const action = 'MOVE';\n\n        if (actions.indexOf(action) !== -1) {\n\n            event.preventDefault();\n\n            const rectangle = event.target.getBoundingClientRect();\n            const x = event.clientX - rectangle.left;\n            const y = event.clientY - rectangle.top;\n\n            inputs.push({\n\n                'type': 'MOUSE',\n                'action': action,\n                'state': 'LEAVE',\n                'x': x,\n                'y': y\n            });\n        }\n    }\n\n    function mousemove(event) {\n\n        const action = 'MOVE';\n\n        if (actions.indexOf(action) !== -1) {\n\n            event.preventDefault();\n\n            const rectangle = event.target.getBoundingClientRect();\n            const x = event.clientX - rectangle.left;\n            const y = event.clientY - rectangle.top;\n\n            inputs.push({\n\n                'type': 'MOUSE',\n                'action': action,\n                'x': x,\n                'y': y\n            });\n        }\n    }\n\n    function mouseup(event) {\n\n        const button = event.button;\n        const buttons = ['LEFT', 'MIDDLE', 'RIGHT'];\n\n        if (typeof buttons[button] === 'undefined') {\n\n            return;\n        }\n\n        const action = 'CLICK_' + buttons[button];\n\n        if (actions.indexOf(action) !== -1) {\n\n            event.preventDefault();\n\n            const rectangle = event.target.getBoundingClientRect();\n            const x = event.clientX - rectangle.left;\n            const y = event.clientY - rectangle.top;\n\n            inputs.push({\n\n                'type': 'MOUSE',\n                'action': action,\n                'state': 'UP',\n                'x': x,\n                'y': y\n            });\n        }\n    }\n\n    function setup() {\n\n        container.addEventListener('contextmenu', contextmenu);\n        container.addEventListener('mousedown', mousedown);\n        container.addEventListener('mouseenter', mouseenter);\n        container.addEventListener('mouseleave', mouseleave);\n        container.addEventListener('mousemove', mousemove);\n        container.addEventListener('mouseup', mouseup);\n        container.addEventListener('wheel', wheel);\n    }\n\n    function wheel(event) {\n\n        const action = 'SCROLL';\n\n        if (actions.indexOf(action) !== -1) {\n\n            event.preventDefault();\n\n            const rectangle = event.target.getBoundingClientRect();\n            const x = event.clientX - rectangle.left;\n            const y = event.clientY - rectangle.top;\n\n            let state;\n\n            if (Math.abs(event.deltaY) >= Math.abs(event.deltaX)) {\n\n                state = 'DOWN';\n\n                if (event.deltaY < 0) {\n\n                    state = 'UP';\n                }\n            }\n\n            else {\n\n                state = 'RIGHT';\n\n                if (event.deltaX < 0) {\n\n                    state = 'LEFT';\n                }\n            }\n\n            inputs.push({\n\n                'type': 'MOUSE',\n                'action': action,\n                'state': state,\n                'x': x,\n                'y': y\n            });\n        }\n    }\n\n    setup.call(this);\n\n    this.destroy = destroy;\n    this.setup = setup;\n}\n\n// exports current module as an object\nexport {Mouse};\n","import {Keyboard} from './keyboard.js';\nimport {Mouse} from './mouse.js';\n\nfunction Controllers(container, actions) {\n\n    const controllers = [];\n    const inputs = [];\n\n    function destroy() {\n\n        controllers.forEach((controller) => {\n\n            controller.destroy();\n        });\n    }\n\n    function setup() {\n\n        controllers.push(new Keyboard(container, actions, inputs));\n        controllers.push(new Mouse(container, actions, inputs));\n    }\n\n    setup.call(this);\n\n    this.destroy = destroy;\n    this.inputs = inputs;\n}\n\n// exports current module as an object\nexport {Controllers};\n","import {loadEntities} from 'core/loadEntities';\nimport {Camera} from 'modules/camera.js';\nimport {Controllers} from 'modules/controllers.js';\nimport {World} from 'modules/world.js';\nimport {getRenderers} from 'core/loadRenderers';\nimport {getSystems} from 'core/loadSystems';\nimport {generateDecor} from 'systems/demo/generateDecor';\n\nfunction start() {\n\n  console.log('start demo scene');\n\n  this.$controllers = new Controllers(this.element, this.models.scenes[this.currentScene]['inputs']());\n  this.$world = new World(this);\n  this.$infos = {started:false};\n\n  this.$origins = {\n      'default': {\n          'x': () => 0,\n          'y': () => 0,\n          'z': () => 0,\n          'scale': () => 1\n      }\n  };\n\n  const scale = () => Math.min((this.size.width / 160), (this.size.height / 144));\n\n  this.$camera = new Camera(this.context, 'default', {\n\n      'x': () => (this.size.width - 160 * scale()) / 2,\n      'y': () => (this.size.height - 144 * scale()) / 2,\n      'width': () => 160 * scale(),\n      'height': () => 144 * scale(),\n      'scale': scale\n  });\n\n  this.$cameraInfo = new Camera(this.context, 'info', {\n\n      'x': () => (this.size.width - 160 * scale()) / 2,\n      'y': () => (this.size.height - 144 * scale()) / 2,\n      'width': () => 160 * scale(),\n      'height': () => 144 * scale(),\n      'scale': scale\n  });\n\n  this.$renderers=getRenderers.call(this);\n  this.$systems=getSystems.call(this);\n\n  var entities = loadEntities.call(this);\n  this.$world.add(entities);\n  generateDecor.call(this,[]);\n  this.$camera.look(()=>this.$world.entities.character.get('position').x+48,()=>72);\n}\n\nexport {start};\n","var map = {\n\t\"./datasets/common/inputs.json\": [\n\t\t32,\n\t\t41\n\t],\n\t\"./images/common/placeholder-8x1.png\": [\n\t\t33,\n\t\t21\n\t],\n\t\"./images/demo/all-flappy-bird-16x16@1x.png\": [\n\t\t34,\n\t\t22\n\t],\n\t\"./images/demo/background-16x16@1x.png\": [\n\t\t35,\n\t\t23\n\t],\n\t\"./images/demo/best-48x16@1x.png\": [\n\t\t36,\n\t\t24\n\t],\n\t\"./images/demo/character-32x32.png\": [\n\t\t37,\n\t\t25\n\t],\n\t\"./images/demo/clouds-160x16@1x.png\": [\n\t\t38,\n\t\t26\n\t],\n\t\"./images/demo/flappy-bird-16x16@1x.png\": [\n\t\t39,\n\t\t27\n\t],\n\t\"./images/demo/flappy-bird-shadow-16x8@1x.png\": [\n\t\t40,\n\t\t28\n\t],\n\t\"./images/demo/foreground-16x16@1x.png\": [\n\t\t41,\n\t\t29\n\t],\n\t\"./images/demo/game-over-64x64@1x.png\": [\n\t\t42,\n\t\t30\n\t],\n\t\"./images/demo/numbers-8x16@1x.png\": [\n\t\t43,\n\t\t31\n\t],\n\t\"./images/demo/numbers-blue-8x16@1x.png\": [\n\t\t44,\n\t\t32\n\t],\n\t\"./images/demo/pipe-16x16@1x.png\": [\n\t\t45,\n\t\t33\n\t],\n\t\"./images/demo/pipe-shadow-16x8@1x.png\": [\n\t\t46,\n\t\t34\n\t],\n\t\"./images/demo/touch-screen-64x32@1x.png\": [\n\t\t47,\n\t\t35\n\t],\n\t\"./images/demo/waves-16x16@1x.png\": [\n\t\t48,\n\t\t36\n\t],\n\t\"./sounds/demo/explode.mp3\": [\n\t\t49,\n\t\t37\n\t],\n\t\"./sounds/demo/jump.mp3\": [\n\t\t50,\n\t\t38\n\t],\n\t\"./spritesheets/common/character-32x32.png\": [\n\t\t51,\n\t\t39\n\t],\n\t\"./spritesheets/common/spritesheet.png\": [\n\t\t52,\n\t\t40\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 26;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./components/common/camera.json\": [\n\t\t53,\n\t\t42\n\t],\n\t\"./components/common/commands.json\": [\n\t\t54,\n\t\t43\n\t],\n\t\"./components/common/fade.json\": [\n\t\t55,\n\t\t44\n\t],\n\t\"./components/common/forces.json\": [\n\t\t56,\n\t\t45\n\t],\n\t\"./components/common/hitbox.json\": [\n\t\t57,\n\t\t46\n\t],\n\t\"./components/common/images.json\": [\n\t\t58,\n\t\t47\n\t],\n\t\"./components/common/inputs.json\": [\n\t\t59,\n\t\t48\n\t],\n\t\"./components/common/origin.json\": [\n\t\t60,\n\t\t49\n\t],\n\t\"./components/common/position.json\": [\n\t\t61,\n\t\t50\n\t],\n\t\"./components/common/timeout.json\": [\n\t\t62,\n\t\t51\n\t],\n\t\"./components/demo/decor.json\": [\n\t\t63,\n\t\t52\n\t],\n\t\"./components/demo/player.json\": [\n\t\t64,\n\t\t53\n\t],\n\t\"./components/demo/score.json\": [\n\t\t65,\n\t\t54\n\t],\n\t\"./entities/demo/background.json\": [\n\t\t66,\n\t\t55\n\t],\n\t\"./entities/demo/bestScore.json\": [\n\t\t67,\n\t\t56\n\t],\n\t\"./entities/demo/bestScoreStatic.json\": [\n\t\t68,\n\t\t57\n\t],\n\t\"./entities/demo/bottom.json\": [\n\t\t69,\n\t\t58\n\t],\n\t\"./entities/demo/character.json\": [\n\t\t70,\n\t\t59\n\t],\n\t\"./entities/demo/checkpoint.json\": [\n\t\t71,\n\t\t60\n\t],\n\t\"./entities/demo/cloud.json\": [\n\t\t72,\n\t\t61\n\t],\n\t\"./entities/demo/pipeBottom.json\": [\n\t\t73,\n\t\t62\n\t],\n\t\"./entities/demo/pipeTop.json\": [\n\t\t74,\n\t\t63\n\t],\n\t\"./entities/demo/score.json\": [\n\t\t75,\n\t\t64\n\t],\n\t\"./entities/demo/splashEnd.json\": [\n\t\t76,\n\t\t65\n\t],\n\t\"./entities/demo/top.json\": [\n\t\t77,\n\t\t66\n\t],\n\t\"./entities/demo/water.json\": [\n\t\t78,\n\t\t67\n\t],\n\t\"./scenes/demo/entities.json\": [\n\t\t79,\n\t\t68\n\t],\n\t\"./scenes/demo/inputs.json\": [\n\t\t80,\n\t\t69\n\t],\n\t\"./scenes/demo/renderers.json\": [\n\t\t81,\n\t\t70\n\t],\n\t\"./scenes/demo/systems.json\": [\n\t\t82,\n\t\t71\n\t],\n\t\"./snippets/demo/ease-in.js\": [\n\t\t83,\n\t\t1\n\t],\n\t\"./snippets/demo/ease-linear.js\": [\n\t\t84,\n\t\t2\n\t],\n\t\"./snippets/demo/ease-out.js\": [\n\t\t85,\n\t\t3\n\t],\n\t\"./snippets/demo/fade-ending.js\": [\n\t\t86,\n\t\t4\n\t],\n\t\"./snippets/demo/forces-down.js\": [\n\t\t87,\n\t\t5\n\t],\n\t\"./snippets/demo/forces-ending.js\": [\n\t\t88,\n\t\t6\n\t],\n\t\"./snippets/demo/forces-handling.js\": [\n\t\t89,\n\t\t7\n\t],\n\t\"./snippets/demo/handle-hitbox-score.js\": [\n\t\t90,\n\t\t8\n\t],\n\t\"./snippets/demo/handle-hitbox.js\": [\n\t\t91,\n\t\t9\n\t],\n\t\"./snippets/demo/timeout-ending.js\": [\n\t\t92,\n\t\t10\n\t],\n\t\"./systems/common/fade.js\": [\n\t\t93,\n\t\t11\n\t],\n\t\"./systems/common/forces.js\": [\n\t\t94,\n\t\t12\n\t],\n\t\"./systems/common/hitbox.js\": [\n\t\t102,\n\t\t13\n\t],\n\t\"./systems/common/images.js\": [\n\t\t95,\n\t\t14\n\t],\n\t\"./systems/common/inputs.js\": [\n\t\t96,\n\t\t15\n\t],\n\t\"./systems/common/previous.js\": [\n\t\t97,\n\t\t16\n\t],\n\t\"./systems/common/showHitbox.js\": [\n\t\t12\n\t],\n\t\"./systems/common/spritesheets.js\": [\n\t\t98,\n\t\t17\n\t],\n\t\"./systems/common/timeout.js\": [\n\t\t99,\n\t\t18\n\t],\n\t\"./systems/demo/commands.js\": [\n\t\t100,\n\t\t19\n\t],\n\t\"./systems/demo/generateDecor.js\": [\n\t\t5\n\t],\n\t\"./systems/demo/updateScore.js\": [\n\t\t101,\n\t\t20\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 27;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./demo/index.js\": 29,\n\t\"./loading/index.js\": 30\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 28;","import {after} from './after.js';\nimport {before} from './before.js';\nimport {destroy} from './destroy.js';\nimport {render} from './render.js';\nimport {resize} from './resize.js';\nimport {setup} from './setup.js';\nimport {start} from './start.js';\nimport {update} from './update.js';\n\nif (typeof module.hot !== 'undefined') {\n\n    module.hot.accept([\n\n        './after.js',\n        './before.js',\n        './destroy.js',\n        './render.js',\n        './resize.js',\n        './setup.js',\n        './start.js',\n        './update.js'\n    ]);\n}\n\nexport {after, before, destroy, render, resize, setup, start, update};\n","import {after} from './after.js';\nimport {before} from './before.js';\nimport {destroy} from './destroy.js';\nimport {render} from './render.js';\nimport {resize} from './resize.js';\nimport {setup} from './setup.js';\nimport {start} from './start.js';\nimport {update} from './update.js';\n\nif (typeof module.hot !== 'undefined') {\n\n    module.hot.accept([\n\n        './after.js',\n        './before.js',\n        './destroy.js',\n        './render.js',\n        './resize.js',\n        './setup.js',\n        './start.js',\n        './update.js'\n    ]);\n}\n\nexport {after, before, destroy, render, resize, setup, start, update};\n","function Canvas(type, identifier, width, height, pixelated = false) {\n\n    const element = document.createElement('canvas');\n    const context = element.getContext(type);\n\n    function focus() {\n\n        element.setAttribute('tabindex', 0);\n        element.focus();\n    }\n\n    function resize(width, height) {\n\n        let ratio = window.devicePixelRatio || 1;\n\n        if (pixelated === true) {\n\n            ratio = Math.floor(ratio);\n        }\n\n        element.setAttribute('height', ratio * height);\n        element.setAttribute('width', ratio * width);\n\n        element.style.height = '100%';\n        element.style.width = '100%';\n\n        context.scale(ratio, ratio);\n\n        if (pixelated === true) {\n\n            sharp();\n        }\n    }\n\n    function sharp() {\n\n        element.style.imageRendering = '-moz-crisp-edges';\n        element.style.imageRendering = '-webkit-crisp-edges';\n        element.style.imageRendering = 'crisp-edges';\n        element.style.imageRendering = 'pixelated';\n        context.imageSmoothingEnabled = false;\n    }\n\n    element.setAttribute('id', identifier);\n    element.addEventListener('mousedown', focus);\n\n    resize(width, height);\n\n    this.context = context;\n    this.element = element;\n    this.focus = focus;\n    this.resize = resize;\n}\n\n// exports current module as an object\nexport {Canvas};\n","function Loop(handler, framerate = 60, speed = 1) {\n\n    let elapsedTime = 0;\n    let lastUpdate = null;\n    let paused = false;\n\n    function update() {\n\n        const currentUpdate = performance.now();\n\n        if (lastUpdate !== null\n        && paused === false) {\n\n            // define elapsed time since last update\n            elapsedTime += currentUpdate - lastUpdate;\n\n            // call user's update handler matching timeframe, speed and fixing browser time handling\n            while (elapsedTime >= 1000 / this.framerate / this.speed\n            && paused === false) {\n\n                // define elapsed time since last user's update handler matching timeframe and speed\n                if (elapsedTime >= 5000) {\n\n                     console.log('droped', elapsedTime);\n\n                     // define elapsed time since last user's update handler matching timeframe and speed\n                     elapsedTime -= elapsedTime;\n\n                     handler(elapsedTime);\n\n                     continue;\n                }\n                elapsedTime -= 1000 / this.framerate / this.speed;\n\n                handler(1000 / this.framerate);\n            }\n        }\n\n        // call user's update handler on each available frame\n        requestAnimationFrame(this.update.bind(this));\n\n        lastUpdate = currentUpdate;\n    }\n\n    function pause() {\n\n        paused = true;\n    }\n\n    function play() {\n\n        paused = false;\n    }\n\n    function tick(times = 1) {\n\n        // call user's update handler on each available frame\n        requestAnimationFrame(() => {\n\n            while (times--) {\n\n                handler(1000 / this.framerate);\n            }\n        });\n    }\n\n    this.framerate = framerate;\n    this.speed = speed;\n\n    this.pause = pause;\n    this.play = play;\n    this.tick = tick;\n    this.update = update;\n}\n\n// exports current module as an object\nexport {Loop};\n","const preloadAssets = function() {\r\n  return new Promise((resolve, reject) => {\r\n\r\n    const context = require.context('assets/', true, /^.\\/.+\\.[a-zA-Z0-9]+$/, 'lazy');\r\n\r\n    let promiseArray = [];\r\n\r\n    this.assetsLoaded=[];\r\n    context.keys().forEach((key) => {\r\n\r\n        let promise = new Promise((resolve, reject) => {\r\n            context(key).then((module) => {\r\n\r\n                var assetLoaded = this.assetsLoaded.find((asset) => {\r\n                    return asset.key == key\r\n                })\r\n\r\n                if ((assetLoaded && assetLoaded.source != module) || assetLoaded === undefined) {\r\n\r\n                    if (assetLoaded !== undefined && assetLoaded.source != module) {\r\n                        let index = this.assetsLoaded.indexOf(assetLoaded)\r\n                        if (index > -1) {\r\n                            this.assetsLoaded.splice(index, 1);\r\n                        }\r\n                    }\r\n\r\n                    loadAsset(key, module).then((asset) => {\r\n\r\n                        this.assetsLoaded.push(asset);\r\n\r\n                        if (typeof this.assets[asset.type + 's'] === 'undefined') {\r\n\r\n                            this.assets[asset.type + 's'] = {};\r\n                        }\r\n\r\n                        if (typeof this.assets[asset.type + 's'][asset.scope] === 'undefined') {\r\n\r\n                            this.assets[asset.type + 's'][asset.scope] = {};\r\n                        }\r\n\r\n                        this.assets[asset.type + 's'][asset.scope][asset.name] = asset.getter;\r\n\r\n                    });\r\n\r\n                }\r\n                resolve(module);\r\n            });\r\n        });\r\n        promiseArray.push(promise);\r\n    });\r\n\r\n    Promise.all(promiseArray).then((modules) => {\r\n        if (module.hot) {\r\n          /*  module.hot.dispose(context.id, (contextId) => {\r\n                preloadAssets.call(this);\r\n            });*/\r\n            module.hot.accept(context.id, (contextId) => {\r\n                preloadAssets.call(this);\r\n            });\r\n        }\r\n        resolve()\r\n    });\r\n\r\n  });\r\n}\r\n\r\nfunction loadAsset(key,module) {\r\n\r\n    // creates a promise for current asset preloading\r\n    return new Promise(function (resolve, reject) {\r\n\r\n        console.log(\"load assets or reload\")\r\n\r\n        const [type, scope, name] = key.match(/(?!\\.\\/|\\/)(.+?)(?=(?:\\.[^\\.\\/]+$)|\\/)/g);\r\n\r\n        const asset = {\r\n            'key': key,\r\n            'name': name,\r\n            'scope': scope,\r\n            'source': module,\r\n            'type': type.substring(0, type.length - 1)\r\n        };\r\n\r\n\r\n        // if current asset is a dataset then preload it\r\n        if (asset.type === 'dataset') {\r\n\r\n            asset.getter = () => asset.source;\r\n\r\n            resolve(asset);\r\n        }\r\n\r\n        // if current asset is an image then preload it\r\n        if (asset.type === 'image' || asset.type === 'spritesheet') {\r\n\r\n            const image = new Image();\r\n\r\n            image.src =  asset.source;\r\n\r\n            // when current image is loaded then resolve current promise\r\n            image.onload = function () {\r\n\r\n                asset.getter = () => image;\r\n\r\n                resolve(asset);\r\n            };\r\n        }\r\n\r\n        // if current asset is a sound then preload it\r\n        else if (asset.type === 'sound') {\r\n\r\n            const sound = new Audio(asset.source);\r\n\r\n            // when current sound is loaded then resolve current promise\r\n            sound.oncanplaythrough = function () {\r\n\r\n                asset.getter = () => sound.cloneNode();\r\n\r\n                resolve(asset);\r\n            };\r\n        }\r\n    });\r\n\r\n}\r\n\r\n\r\nexport {preloadAssets}\r\n","const preloadModels = function() {\r\n\r\n return new Promise((resolve, reject) => {\r\n    const context = require.context('models/', true, /^.\\/.+\\.[a-zA-Z0-9]+$/, 'lazy');\r\n\r\n    let promiseArray = [];\r\n\r\n    this.modelsLoaded=[];\r\n    context.keys().forEach((key) => {\r\n\r\n        let promise = new Promise((resolve, reject) => {\r\n            context(key).then((module) => {\r\n\r\n                var componentLoaded = this.modelsLoaded.find((component) => {\r\n                    return component.key == key\r\n                })\r\n\r\n                if ((componentLoaded && componentLoaded.source != module) || componentLoaded === undefined) {\r\n\r\n                    if (componentLoaded !== undefined && componentLoaded.source != module) {\r\n                        let index = this.modelsLoaded.indexOf(componentLoaded)\r\n                        if (index > -1) {\r\n                            this.modelsLoaded.splice(index, 1);\r\n                        }\r\n                    }\r\n\r\n                    loadModel.call(this,key, module).then((component) => {\r\n\r\n                        this.modelsLoaded.push(component);\r\n\r\n                        if (typeof this.models[component.type + 's'] === 'undefined') {\r\n\r\n                            this.models[component.type + 's'] = {};\r\n                        }\r\n\r\n                        if (typeof this.models[component.type + 's'][component.scope] === 'undefined') {\r\n\r\n                            this.models[component.type + 's'][component.scope] = {};\r\n                        }\r\n\r\n                        this.models[component.type + 's'][component.scope][component.name] = component.getter;\r\n\r\n                    });\r\n\r\n                }\r\n                resolve(module);\r\n            });\r\n        });\r\n        promiseArray.push(promise);\r\n    });\r\n\r\n    Promise.all(promiseArray).then((modules) => {\r\n        if (module.hot) {\r\n          /*  module.hot.dispose(context.id, (contextId) => {\r\n                preloadModels.call(this);\r\n            });*/\r\n            module.hot.accept(context.id, (contextId) => {\r\n                preloadModels.call(this);\r\n            });\r\n        }\r\n        resolve()\r\n    });\r\n  });\r\n}\r\n\r\nfunction loadModel(key,module) {\r\n\r\n    // creates a promise for current asset preloading\r\n    return new Promise((resolve, reject)=> {\r\n\r\n        console.log(\"load models or reload\")\r\n\r\n        const [type, scope, name] = key.match(/(?!\\.\\/|\\/)(.+?)(?=(?:\\.[^\\.\\/]+$)|\\/)/g);\r\n\r\n        const asset = {\r\n            'key': key,\r\n            'name': name,\r\n            'scope': scope,\r\n            'source': module,\r\n            'type': type.substring(0, type.length - 1)\r\n        };\r\n\r\n\r\n        if (type === 'snippets') {\r\n            asset.getter = asset.source.default.bind(this);\r\n            resolve(asset);\r\n        }else{\r\n          asset.getter = () => asset.source;\r\n        }\r\n\r\n          resolve(asset);\r\n\r\n    });\r\n\r\n}\r\nexport {preloadModels}\r\n","const preloadScenes =function() {\r\n\r\n    const context = require.context('scenes/', true, /^\\.\\/[^\\/]+\\/index\\.js$/, 'sync');\r\n\r\n    context.keys().forEach((key) => {\r\n\r\n        const name = key.match(/^\\.\\/([^\\/]+)\\/index\\.js$/)[1];\r\n\r\n        this.scenes[name] = context(key);\r\n    });\r\n}\r\n\r\nexport {preloadScenes};\r\n","import {Theatre} from 'core/theatre.js';\n\nvar container = document.body.querySelector('.theatre-container');\n\nnew Theatre({\n    'container': container,\n    'expose': true,\n    'sharp': true\n});\n","//import * as scenes from 'scenes/index.js';\nimport {Canvas} from 'core/canvas.js';\nimport {Loop} from 'core/loop.js';\n\nimport {preloadAssets} from 'core/preloadAssets.js';\nimport {preloadModels} from 'core/preloadModels.js';\nimport {preloadScenes} from 'core/preloadScenes.js';\n\nfunction Theatre(config) {\n\n    const {container} = config;\n\n    const expose = config.expose || false;\n    const framerate = config.framerate || 60;\n    const sharp = config.sharp || false;\n    const speed = config.speed || 1;\n\n    const size = {\n        'height': container.offsetHeight,\n        'width': container.offsetWidth\n    };\n\n\n    let canvas = null;\n    let loading = null;\n    let restarting = false;\n    let updates = 0;\n\n\n        function forward(timeframe) {\n\n            this.delta = timeframe;\n\n            if (container.offsetWidth !== this.size.width\n            || container.offsetHeight !== this.size.height) {\n\n                resize.call(this);\n            }\n\n            if (this.playing === true) {\n\n                this.tick();\n            }\n\n            this.scene.before.call(this);\n\n            if (updates > 0) {\n\n                update.call(this);\n            }\n\n            this.scene.render.call(this);\n            this.scene.after.call(this);\n        }\n\n\n    function initialize() {\n\n        canvas = new Canvas('2d', 'theatre', this.size.width, this.size.height, sharp);\n\n        container.appendChild(canvas.element);\n\n        canvas.focus();\n\n        this.container = container;\n        this.context = canvas.context;\n        this.element = canvas.element;\n        this.models= {};\n        this.assets = {};\n        this.delta = 0;\n\n        this.loop = new Loop(forward.bind(this), framerate, speed);\n        var promisePreloadAssets=preloadAssets.call(this);\n        var promisePreloadModels=preloadModels.call(this);\n        preloadScenes.call(this);\n\n        Promise.all([promisePreloadAssets,promisePreloadModels]).then((modules) => {\n          this.preloading=false;\n        });\n\n\n/*        assets.call(this);\n        components.call(this);\n        snippets.call(this);\n        scenes.call(this);*/\n\n        this.scene = this.scenes.loading;\n        this.scene.setup.call(this);\n        this.scene.start.call(this);\n\n        this.loop.update();\n    }\n\n\n        function load(scene) {\n\n            loading = scene;\n        }\n\n        function pause() {\n\n            this.playing = false;\n        }\n\n        function play() {\n\n            this.playing = true;\n        }\n\n        function resize() {\n\n            this.size.width = container.offsetWidth;\n            this.size.height = container.offsetHeight;\n\n            canvas.resize(this.size.width, this.size.height);\n\n            this.scene.resize.call(this);\n        }\n\n        function restart() {\n\n            restarting = true;\n        }\n\n\n\n    function tick(times = 1) {\n\n        updates += times;\n    }\n\n    function update() {\n\n        while (updates > 0) {\n\n            this.scene.update.call(this);\n\n            updates -= 1;\n\n            if (restarting === true) {\n\n                this.scene.start.call(this);\n\n                restarting = false;\n\n                continue;\n            }\n\n            if (loading !== null) {\n\n                this.scene.destroy.call(this);\n                this.scene = this.scenes[loading];\n                this.currentScene=loading;\n                this.scene.setup.call(this);\n                this.scene.start.call(this);\n\n                loading = null;\n\n                continue;\n            }\n        }\n    }\n\n    this.playing = true;\n    this.preloading = true;\n    this.currentScene;\n    this.$={};\n    this.scenes = {};\n    this.size = size;\n    this.snippets = {};\n    this.state = {};\n    this.version = '0.39.0';\n    this.cachedEntities={};\n    this.load = load;\n    this.pause = pause;\n    this.play = play;\n    this.restart = restart;\n    this.tick = tick;\n\n    initialize.call(this, config);\n\n    if (expose === true) {\n\n        window.theatre = this;\n    }\n}\n\n// exports current module as an object\nexport {\n    Theatre\n};\n"],"sourceRoot":""}