{"version":3,"sources":["webpack:///./sources/game/models/systems/demo/updateScore.js"],"names":["updateScore","entities","Object","entries","forEach","entity","parts","get","score","numberStr","part","i","findNumber","parseInt","value","newParts","scoreStr","toString","length","createNumberImagePart","isBestScore","push","images","newImages","createComponentFromModel","call","add","frames","number","index"],"mappings":"2iBAEA,SAASA,EAAYC,GAAU,WAE3BC,OAAOC,QAAQF,GAAUG,SAAQ,YAAiB,aAAVC,GAAU,WAC5CC,EAAMD,EAAOE,IAAI,UAAUD,MAC3BE,EAAMH,EAAOE,IAAI,SACjBE,EAAU,GAKd,GAJAH,EAAMF,SAAQ,SAACM,EAAMC,GACnBF,GAAWG,EAAWF,MAGrBG,SAASJ,IAAYD,EAAMM,MAAM,CAGlC,IAFA,IAAIC,EAAS,GACTC,EAASR,EAAMM,MAAMG,WAChBN,EAAI,EAAGA,EAAIK,EAASE,OAAQP,IAAK,CACxC,IAAID,EAAKS,EAAsBN,SAASG,EAASL,IAAIA,EAAEK,EAASE,OAAOV,EAAMY,aAC7EL,EAASM,KAAKX,GAGhB,IAAIY,EAAO,CACT,KAAO,SACP,MAAQ,SACR,OAAS,CACP,MAAQP,IAIRQ,EAAYC,IAAyBC,KAAK,EAAMH,GACpDjB,EAAOqB,IAAIH,OAMnB,IAAMX,EAAW,SAASF,GACtB,OAAOA,EAAKiB,OAAO,GAAG,GAAGV,YAGvBE,EAAsB,SAASS,EAAOC,EAAMX,EAAOE,GAIvD,MAAO,CACL,OAAU,CACR,MAAQ,OACR,KAJKA,EAAY,uBAAuB,mBAM1C,OAAU,CACN,CAACQ,EAAQ,EAAG,EAAG,KAEnB,MAAS,EACT,YAAe,CAXW,GAATC,EAAM,GAAO,EAAEX,EAWF,EAAG,EAAG,EAAG","file":"20.index.js","sourcesContent":["import {createComponentFromModel} from 'core/loadEntities.js';\r\n\r\nfunction updateScore(entities) {\r\n\r\n    Object.entries(entities).forEach(([name,entity])=>{\r\n      let parts=entity.get('images').parts;\r\n      let score=entity.get('score');\r\n      let numberStr=\"\"\r\n      parts.forEach((part, i) => {\r\n        numberStr+=findNumber(part);\r\n      });\r\n\r\n      if(parseInt(numberStr)!=score.value){\r\n        let newParts=[];\r\n        let scoreStr=score.value.toString();\r\n        for (var i = 0; i < scoreStr.length; i++) {\r\n          let part=createNumberImagePart(parseInt(scoreStr[i]),i,scoreStr.length,score.isBestScore);\r\n          newParts.push(part);\r\n        }\r\n\r\n        let images={\r\n          \"name\":\"images\",\r\n          \"scope\":\"common\",\r\n          \"params\":{\r\n            \"parts\":newParts\r\n          }\r\n        }\r\n\r\n        let newImages = createComponentFromModel.call(this, images);\r\n        entity.add(newImages);\r\n      }\r\n\r\n    });\r\n}\r\n\r\nconst findNumber=function(part){\r\n    return part.frames[0][0].toString();\r\n}\r\n\r\nconst createNumberImagePart=function(number,index,length,isBestScore){\r\n\r\n  let destinationX=((index+1)*8)-(8*length);\r\n  let file=isBestScore?\"numbers-blue-8x16@1x\":\"numbers-8x16@1x\"\r\n  return {\r\n    \"source\": {\r\n      \"scope\":\"demo\",\r\n      \"file\":file\r\n    },\r\n    \"frames\": [\r\n        [number, 0, 8, 16]\r\n    ],\r\n    \"frame\": 0,\r\n    \"destination\": [destinationX, 0, 0, 8, 16]\r\n  }\r\n}\r\n\r\nexport {updateScore};\r\n"],"sourceRoot":""}